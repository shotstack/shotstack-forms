var Shotstack=function(){"use strict";var it=Object.defineProperty;var st=(T,D,x)=>D in T?it(T,D,{enumerable:!0,configurable:!0,writable:!0,value:x}):T[D]=x;var Y=(T,D,x)=>(st(T,typeof D!="symbol"?D+"":D,x),x);function T(){}function D(t){return t()}function x(){return Object.create(null)}function Q(t){t.forEach(D)}function _e(t){return typeof t=="function"}function pe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let F;function ge(t,e){return F||(F=document.createElement("a")),F.href=e,t===F.href}function ye(t){return Object.keys(t).length===0}let J=!1;function ve(){J=!0}function Ee(){J=!1}function Me(t,e,r,n){for(;t<e;){const a=t+(e-t>>1);r(a)<=n?t=a+1:e=a}return t}function Ie(t){if(t.hydrate_init)return;t.hydrate_init=!0;let e=t.childNodes;if(t.nodeName==="HEAD"){const l=[];for(let o=0;o<e.length;o++){const u=e[o];u.claim_order!==void 0&&l.push(u)}e=l}const r=new Int32Array(e.length+1),n=new Int32Array(e.length);r[0]=-1;let a=0;for(let l=0;l<e.length;l++){const o=e[l].claim_order,u=(a>0&&e[r[a]].claim_order<=o?a+1:Me(1,a,_=>e[r[_]].claim_order,o))-1;n[l]=r[u]+1;const h=u+1;r[h]=l,a=Math.max(h,a)}const c=[],i=[];let s=e.length-1;for(let l=r[a]+1;l!=0;l=n[l-1]){for(c.push(e[l-1]);s>=l;s--)i.push(e[s]);s--}for(;s>=0;s--)i.push(e[s]);c.reverse(),i.sort((l,o)=>l.claim_order-o.claim_order);for(let l=0,o=0;l<i.length;l++){for(;o<c.length&&i[l].claim_order>=c[o].claim_order;)o++;const u=o<c.length?c[o]:null;t.insertBefore(i[l],u)}}function m(t,e){if(J){for(Ie(t),(t.actual_end_child===void 0||t.actual_end_child!==null&&t.actual_end_child.parentNode!==t)&&(t.actual_end_child=t.firstChild);t.actual_end_child!==null&&t.actual_end_child.claim_order===void 0;)t.actual_end_child=t.actual_end_child.nextSibling;e!==t.actual_end_child?(e.claim_order!==void 0||e.parentNode!==t)&&t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling}else(e.parentNode!==t||e.nextSibling!==null)&&t.appendChild(e)}function z(t,e,r){J&&!r?m(t,e):(e.parentNode!==t||e.nextSibling!=r)&&t.insertBefore(e,r||null)}function p(t){t.parentNode.removeChild(t)}function Ne(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function v(t){return document.createElement(t)}function C(t){return document.createTextNode(t)}function A(){return C(" ")}function q(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function d(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function I(t){return Array.from(t.childNodes)}function be(t){t.claim_info===void 0&&(t.claim_info={last_index:0,total_claimed:0})}function re(t,e,r,n,a=!1){be(t);const c=(()=>{for(let i=t.claim_info.last_index;i<t.length;i++){const s=t[i];if(e(s)){const l=r(s);return l===void 0?t.splice(i,1):t[i]=l,a||(t.claim_info.last_index=i),s}}for(let i=t.claim_info.last_index-1;i>=0;i--){const s=t[i];if(e(s)){const l=r(s);return l===void 0?t.splice(i,1):t[i]=l,a?l===void 0&&t.claim_info.last_index--:t.claim_info.last_index=i,s}}return n()})();return c.claim_order=t.claim_info.total_claimed,t.claim_info.total_claimed+=1,c}function Te(t,e,r,n){return re(t,a=>a.nodeName===e,a=>{const c=[];for(let i=0;i<a.attributes.length;i++){const s=a.attributes[i];r[s.name]||c.push(s.name)}c.forEach(i=>a.removeAttribute(i))},()=>n(e))}function E(t,e,r){return Te(t,e,r,v)}function L(t,e){return re(t,r=>r.nodeType===3,r=>{const n=""+e;if(r.data.startsWith(n)){if(r.data.length!==n.length)return r.splitText(n.length)}else r.data=n},()=>C(e),!0)}function j(t){return L(t," ")}function Z(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}let W;function R(t){W=t}const P=[],ne=[],V=[],le=[],De=Promise.resolve();let X=!1;function we(){X||(X=!0,De.then(ie))}function K(t){V.push(t)}const ee=new Set;let B=0;function ie(){const t=W;do{for(;B<P.length;){const e=P[B];B++,R(e),Ae(e.$$)}for(R(null),P.length=0,B=0;ne.length;)ne.pop()();for(let e=0;e<V.length;e+=1){const r=V[e];ee.has(r)||(ee.add(r),r())}V.length=0}while(P.length);for(;le.length;)le.pop()();X=!1,ee.clear(),R(t)}function Ae(t){if(t.fragment!==null){t.update(),Q(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(K)}}const je=new Set;function Se(t,e){t&&t.i&&(je.delete(t),t.i(e))}function xe(t,e,r,n){const{fragment:a,on_mount:c,on_destroy:i,after_update:s}=t.$$;a&&a.m(e,r),n||K(()=>{const l=c.map(D).filter(_e);i?i.push(...l):Q(l),t.$$.on_mount=[]}),s.forEach(K)}function Ce(t,e){const r=t.$$;r.fragment!==null&&(Q(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function Le(t,e){t.$$.dirty[0]===-1&&(P.push(t),we(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Oe(t,e,r,n,a,c,i,s=[-1]){const l=W;R(t);const o=t.$$={fragment:null,ctx:null,props:c,update:T,not_equal:a,bound:x(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:x(),dirty:s,skip_bound:!1,root:e.target||l.$$.root};i&&i(o.root);let u=!1;if(o.ctx=r?r(t,e.props||{},(h,_,...b)=>{const g=b.length?b[0]:_;return o.ctx&&a(o.ctx[h],o.ctx[h]=g)&&(!o.skip_bound&&o.bound[h]&&o.bound[h](g),u&&Le(t,h)),_}):[],o.update(),u=!0,Q(o.before_update),o.fragment=n?n(o.ctx):!1,e.target){if(e.hydrate){ve();const h=I(e.target);o.fragment&&o.fragment.l(h),h.forEach(p)}else o.fragment&&o.fragment.c();e.intro&&Se(t.$$.fragment),xe(t,e.target,e.anchor,e.customElement),Ee(),ie()}R(l)}class ke{$destroy(){Ce(this,1),this.$destroy=T}$on(e,r){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const a=n.indexOf(r);a!==-1&&n.splice(a,1)}}$set(e){this.$$set&&!ye(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const at="",ot="",Ye="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MS4yIDUxLjIiIHdpZHRoPSI1MS4yIiBoZWlnaHQ9IjUxLjIiID4KICAgIDxzdmcgd2lkdGg9IjUxLjIiIGhlaWdodD0iNTEuMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiPgogICAgICAgIDxwYXRoCiAgICAgICAgICAgIGQ9Ik01MDIuNiA3MC42M2wtNjEuMjUtNjEuMjVDNDM1LjQgMy4zNzEgNDI3LjIgMCA0MTguNyAwSDI1NS4xYy0zNS4zNSAwLTY0IDI4LjY2LTY0IDY0bC4wMTk1IDI1NkMxOTIgMzU1LjQgMjIwLjcgMzg0IDI1NiAzODRoMTkyYzM1LjIgMCA2NC0yOC44IDY0LTY0VjkzLjI1QzUxMiA4NC43NyA1MDguNiA3Ni42MyA1MDIuNiA3MC42M3pNNDY0IDMyMGMwIDguODM2LTcuMTY0IDE2LTE2IDE2SDI1NS4xYy04LjgzOCAwLTE2LTcuMTY0LTE2LTE2TDIzOS4xIDY0LjEzYzAtOC44MzYgNy4xNjQtMTYgMTYtMTZoMTI4TDM4NCA5NmMwIDE3LjY3IDE0LjMzIDMyIDMyIDMyaDQ3LjFWMzIwek0yNzIgNDQ4YzAgOC44MzYtNy4xNjQgMTYtMTYgMTZINjMuMWMtOC44MzggMC0xNi03LjE2NC0xNi0xNkw0Ny45OCAxOTIuMWMwLTguODM2IDcuMTY0LTE2IDE2LTE2SDE2MFYxMjhINjMuOTljLTM1LjM1IDAtNjQgMjguNjUtNjQgNjRsLjAwOTggMjU2Qy4wMDIgNDgzLjMgMjguNjYgNTEyIDY0IDUxMmgxOTJjMzUuMiAwIDY0LTI4LjggNjQtNjR2LTMyaC00Ny4xTDI3MiA0NDh6IiAvPgogICAgPC9zdmc+Cjwvc3ZnPg==",ze="A 'merge' property is required",Re="Property 'merge' must be an array",Pe="Property 'merge' must contain at least one element",$e="A 'find' property is required on every element inside 'merge'",Ue="Every 'find' property inside 'merge' must be of type string",Qe="Every 'find' property inside 'merge' must be a string of length equal to or higher than one",Fe="A 'replace' property is required on every element inside 'merge'",Je="Unexpected error while parsing template JSON",Ve="Every element inside the 'merge' should be an object";class w extends Error{constructor(e){super(e)}}function Be(t){return typeof t=="object"}function $(t,e){return t in e}function te(t,e){return!$(t,e)}function Ge(t,e){return $(t,e)&&!(e[t]instanceof Array)}function He(t,e){return $(t,e)&&typeof e[t]!="string"}function qe(t,e){const r=$(t,e)&&e[t];return!(typeof r=="string"&&r.length>0)}function Ze(t,e){const r=$(t,e)&&e[t];return!(r instanceof Array&&r.length>0)}function We(t){try{const e=JSON.parse(t);if(te("merge",e))throw new w(ze);if(Ge("merge",e))throw new w(Re);if(Ze("merge",e))throw new w(Pe);const{merge:r}=e,n=Xe(r);return{...e,merge:n}}catch(e){throw se(e)}}function Xe(t){return t.map(r=>{if(!Be(r))throw new w(Ve);if(te("find",r))throw new w($e);if(te("replace",r))throw new w(Fe);if(He("find",r))throw new w(Ue);if(qe("find",r))throw new w(Qe);return r}).map(({find:r,replace:n})=>({find:r,replace:ae(n)}))}function Ke(t){return typeof t=="object"&&t!==null&&"message"in t}function se(t){return t instanceof Error?t:Ke(t)?new w(t.message):new w(Je)}function ae(t){return typeof t=="string"?t:JSON.stringify(t)}class oe{constructor(e){Y(this,"template");Y(this,"_result");Y(this,"_error");Y(this,"handlers");this._error=null,this.template={merge:[]},this._result={merge:[]},this.handlers={change:[],submit:[],error:[this.logger]},this.setTemplateSource(e)}set error(e){const r=this._error&&{...this._error}||null;this._error=e,e!==null&&this.handlers.error.forEach(n=>n(e,r))}get error(){return this._error}set result(e){const r={...this._result};this._result=e,this.handlers.change.forEach(n=>n(e,r))}get result(){return this._result}on(e,r){this.handlers[e].push(r)}off(e,r){this.handlers={...this.handlers,[e]:this.handlers[e].filter(n=>n!==r)}}submit(){if(this.error)throw this.error;this.handlers.submit.forEach(e=>e(this.result))}setTemplateSource(e){try{const r=We(ae(e));this.template=r,this.result=r,this.error=null}catch(r){const n=se(r);this.error=n}}updateResultMergeFields(e){const{find:r,replace:n}=e,a={find:r,replace:n},c=this.result.merge.map(i=>(i==null?void 0:i.find)===e.find?a:i);return this.result={...this.result,merge:c},c}logger(e){console.error(e)}}const et={merge:[{find:"NAME",replace:"world"}],timeline:{tracks:[{clips:[{asset:{type:"title",text:"Hello {{ NAME }}",style:"future"},start:0,length:5}]}]},output:{format:"mp4",resolution:"hd"}},dt="";function ce(t,e,r){const n=t.slice();return n[9]=e[r].find,n[10]=e[r].replace,n}function ue(t){let e,r,n=t[2].message+"",a;return{c(){e=v("p"),r=v("span"),a=C(n),this.h()},l(c){e=E(c,"P",{"data-cy":!0,class:!0});var i=I(e);r=E(i,"SPAN",{class:!0});var s=I(r);a=L(s,n),s.forEach(p),i.forEach(p),this.h()},h(){d(r,"class","monospace text-orange-900 svelte-r93edu"),d(e,"data-cy","template-input-error"),d(e,"class","bg-rose-200 rounded py-2 px-4 svelte-r93edu")},m(c,i){z(c,e,i),m(e,r),m(r,a)},p(c,i){i&4&&n!==(n=c[2].message+"")&&Z(a,n)},d(c){c&&p(e)}}}function fe(t){let e,r,n,a,c,i=t[0].merge,s=[];for(let l=0;l<i.length;l+=1)s[l]=de(ce(t,i,l));return{c(){e=v("div"),r=v("h1"),n=C("Modify Merge Values"),a=A(),c=v("div");for(let l=0;l<s.length;l+=1)s[l].c();this.h()},l(l){e=E(l,"DIV",{"data-cy":!0,class:!0});var o=I(e);r=E(o,"H1",{class:!0});var u=I(r);n=L(u,"Modify Merge Values"),u.forEach(p),a=j(o),c=E(o,"DIV",{class:!0});var h=I(c);for(let _=0;_<s.length;_+=1)s[_].l(h);h.forEach(p),o.forEach(p),this.h()},h(){d(r,"class","text-teal-400 px-1 svelte-r93edu"),d(c,"class","border p-4 mb-6 svelte-r93edu"),d(e,"data-cy","merge-fields-input-section"),d(e,"class","svelte-r93edu")},m(l,o){z(l,e,o),m(e,r),m(r,n),m(e,a),m(e,c);for(let u=0;u<s.length;u+=1)s[u].m(c,null)},p(l,o){if(o&17){i=l[0].merge;let u;for(u=0;u<i.length;u+=1){const h=ce(l,i,u);s[u]?s[u].p(h,o):(s[u]=de(h),s[u].c(),s[u].m(c,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=i.length}},d(l){l&&p(e),Ne(s,l)}}}function de(t){let e,r,n="{{ "+t[9]+" }} ",a,c,i,s,l,o,u,h,_;function b(...g){return t[8](t[9],...g)}return{c(){e=v("div"),r=v("label"),a=C(n),i=A(),s=v("input"),u=A(),this.h()},l(g){e=E(g,"DIV",{"data-cy":!0,class:!0});var f=I(e);r=E(f,"LABEL",{for:!0,class:!0});var y=I(r);a=L(y,n),y.forEach(p),i=j(f),s=E(f,"INPUT",{class:!0,id:!0,type:!0}),u=j(f),f.forEach(p),this.h()},h(){d(r,"for",c=t[9]),d(r,"class","block mb-2 monospace svelte-r93edu"),d(s,"class","border w-full mb-3 pl-2 py-1 text-stone-500 svelte-r93edu"),d(s,"id",l=t[9]),d(s,"type","text"),s.value=o=t[10],d(e,"data-cy","label-input"),d(e,"class","svelte-r93edu")},m(g,f){z(g,e,f),m(e,r),m(r,a),m(e,i),m(e,s),m(e,u),h||(_=q(s,"input",b),h=!0)},p(g,f){t=g,f&1&&n!==(n="{{ "+t[9]+" }} ")&&Z(a,n),f&1&&c!==(c=t[9])&&d(r,"for",c),f&1&&l!==(l=t[9])&&d(s,"id",l),f&1&&o!==(o=t[10])&&s.value!==o&&(s.value=o)},d(g){g&&p(e),h=!1,_()}}}function he(t){let e,r,n,a,c,i,s,l,o,u=G(t[1])+"",h,_,b;return{c(){e=v("div"),r=v("h1"),n=C("Result"),a=A(),c=v("abbr"),i=v("img"),l=A(),o=v("p"),h=C(u),this.h()},l(g){e=E(g,"DIV",{"data-cy":!0,class:!0});var f=I(e);r=E(f,"H1",{class:!0});var y=I(r);n=L(y,"Result"),y.forEach(p),a=j(f),c=E(f,"ABBR",{title:!0,class:!0});var M=I(c);i=E(M,"IMG",{src:!0,alt:!0,class:!0}),M.forEach(p),l=j(f),o=E(f,"P",{"data-cy":!0,class:!0});var U=I(o);h=L(U,u),U.forEach(p),f.forEach(p),this.h()},h(){d(r,"class","text-teal-400 px-1 inline-block mr-2 svelte-r93edu"),ge(i.src,s=Ye)||d(i,"src",s),d(i,"alt","copy-button"),d(i,"class","h-4 cursor-pointer inline mb-1 svelte-r93edu"),d(c,"title","Copy to clipboard"),d(c,"class","svelte-r93edu"),d(o,"data-cy","result"),d(o,"class","h-60 overflow-auto border p-4 whitespace-pre monospace svelte-r93edu"),d(e,"data-cy","result-section"),d(e,"class","svelte-r93edu")},m(g,f){z(g,e,f),m(e,r),m(r,n),m(e,a),m(e,c),m(c,i),m(e,l),m(e,o),m(o,h),_||(b=q(i,"click",t[5]),_=!0)},p(g,f){f&2&&u!==(u=G(g[1])+"")&&Z(h,u)},d(g){g&&p(e),_=!1,b()}}}function tt(t){var U;let e,r,n,a,c,i,s,l,o,u,h,_,b,g,f=t[2]&&ue(t),y=((U=t[0].merge)==null?void 0:U.length)&&!t[2]&&fe(t),M=!t[2]&&he(t);return{c(){e=v("div"),r=v("section"),n=v("form"),a=v("div"),c=v("label"),i=C("Paste template"),s=A(),l=v("textarea"),u=A(),f&&f.c(),h=A(),y&&y.c(),_=A(),M&&M.c(),this.h()},l(N){e=E(N,"DIV",{class:!0});var S=I(e);r=E(S,"SECTION",{"data-cy":!0,class:!0});var O=I(r);n=E(O,"FORM",{class:!0});var k=I(n);a=E(k,"DIV",{"data-cy":!0,class:!0});var H=I(a);c=E(H,"LABEL",{for:!0,class:!0});var me=I(c);i=L(me,"Paste template"),me.forEach(p),s=j(H),l=E(H,"TEXTAREA",{"data-cy":!0,class:!0,id:!0}),I(l).forEach(p),H.forEach(p),u=j(k),f&&f.l(k),h=j(k),y&&y.l(k),k.forEach(p),_=j(O),M&&M.l(O),O.forEach(p),S.forEach(p),this.h()},h(){d(c,"for","json-input"),d(c,"class","text-teal-400 px-1 svelte-r93edu"),d(l,"data-cy","template-input"),d(l,"class","w-full h-60 monospace border p-4 overflow-auto whitespace-pre resize-none svelte-r93edu"),d(l,"id","json-input"),l.value=o=G(t[0]),d(a,"data-cy","template-input-section"),d(a,"class","mb-6 svelte-r93edu"),d(n,"class","svelte-r93edu"),d(r,"data-cy","form-container"),d(r,"class","max-w-lg my-4 mx-auto border rounded-xl px-7 py-4 svelte-r93edu"),d(e,"class","shotstack-mergefield-form svelte-r93edu")},m(N,S){z(N,e,S),m(e,r),m(r,n),m(n,a),m(a,c),m(c,i),m(a,s),m(a,l),m(n,u),f&&f.m(n,null),m(n,h),y&&y.m(n,null),m(r,_),M&&M.m(r,null),b||(g=q(l,"input",t[7]),b=!0)},p(N,[S]){var O;S&1&&o!==(o=G(N[0]))&&(l.value=o),N[2]?f?f.p(N,S):(f=ue(N),f.c(),f.m(n,h)):f&&(f.d(1),f=null),((O=N[0].merge)==null?void 0:O.length)&&!N[2]?y?y.p(N,S):(y=fe(N),y.c(),y.m(n,null)):y&&(y.d(1),y=null),N[2]?M&&(M.d(1),M=null):M?M.p(N,S):(M=he(N),M.c(),M.m(r,null))},i:T,o:T,d(N){N&&p(e),f&&f.d(),y&&y.d(),M&&M.d(),b=!1,g()}}}function G(t){return JSON.stringify(t,null,2)}function rt(t,e,r){let{editTemplateService:n=new oe(et)}=e,a=n.template,c=n.result,i=null;function s(_){n.setTemplateSource(_),r(0,a=n.template),r(1,c=n.result),r(2,i=n.error)}function l(_){n.updateResultMergeFields(_),r(1,c=n.result)}function o(){navigator.clipboard.writeText(JSON.stringify(c)),alert("JSON copied to clipboard!")}const u=_=>s(_.currentTarget.value),h=(_,b)=>l({find:_,replace:b.currentTarget.value});return t.$$set=_=>{"editTemplateService"in _&&r(6,n=_.editTemplateService)},[a,c,i,s,l,o,n,u,h]}class nt extends ke{constructor(e){super(),Oe(this,e,rt,tt,pe,{editTemplateService:6})}}class lt{constructor(e,r=document.querySelector("#shotstack-form-field")){Y(this,"templateService");this.containerElement=r,this.templateService=new oe(e),this.initialize()}on(e,r){this.templateService.on(e,r)}off(e,r){this.templateService.off(e,r)}submit(){this.templateService.submit()}initialize(){!this.containerElement||this.containerElement&&this.render(this.containerElement)}render(e){new nt({target:e,props:{editTemplateService:this.templateService}})}display(){!this.containerElement||(this.containerElement.style.display="block")}hide(){!this.containerElement||(this.containerElement.style.display="none")}attach(e){this.remove(),this.containerElement=e,this.render(this.containerElement)}remove(){!this.containerElement||this.containerElement.replaceChildren()}get container(){if(!!this.containerElement)return this.containerElement}merge(){return this.templateService.result}}return lt}();
