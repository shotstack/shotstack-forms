var Shotstack=function(){"use strict";function v(){}function Be(n,e){for(const t in e)n[t]=e[t];return n}function me(n){return n()}function ge(){return Object.create(null)}function Y(n){n.forEach(me)}function H(n){return typeof n=="function"}function T(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}let V;function Je(n,e){return V||(V=document.createElement("a")),V.href=e,n===V.href}function Qe(n){return Object.keys(n).length===0}function He(n,...e){if(n==null)return v;const t=n.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function he(n,e,t){n.$$.on_destroy.push(He(e,t))}function Ve(n,e,t,l){if(n){const r=pe(n,e,t,l);return n[0](r)}}function pe(n,e,t,l){return n[1]&&l?Be(t.ctx.slice(),n[1](l(e))):t.ctx}function Ge(n,e,t,l){if(n[2]&&l){const r=n[2](l(t));if(e.dirty===void 0)return r;if(typeof r=="object"){const s=[],i=Math.max(e.dirty.length,r.length);for(let o=0;o<i;o+=1)s[o]=e.dirty[o]|r[o];return s}return e.dirty|r}return e.dirty}function qe(n,e,t,l,r,s){if(r){const i=pe(e,t,l,s);n.p(i,r)}}function Ze(n){if(n.ctx.length>32){const e=[],t=n.ctx.length/32;for(let l=0;l<t;l++)e[l]=-1;return e}return-1}function h(n,e){n.appendChild(e)}function M(n,e,t){n.insertBefore(e,t||null)}function I(n){n.parentNode.removeChild(n)}function _e(n,e){for(let t=0;t<n.length;t+=1)n[t]&&n[t].d(e)}function p(n){return document.createElement(n)}function G(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function $(n){return document.createTextNode(n)}function E(){return $(" ")}function A(n,e,t,l){return n.addEventListener(e,t,l),()=>n.removeEventListener(e,t,l)}function se(n){return function(e){return e.preventDefault(),n.call(this,e)}}function f(n,e,t){t==null?n.removeAttribute(e):n.getAttribute(e)!==t&&n.setAttribute(e,t)}function We(n){return Array.from(n.childNodes)}function q(n,e){e=""+e,n.wholeText!==e&&(n.data=e)}function be(n,e){n.value=e==null?"":e}function x(n,e,t){n.classList[t?"add":"remove"](e)}let ie;function B(n){ie=n}const J=[],Z=[],W=[],ue=[],Xe=Promise.resolve();let oe=!1;function Ke(){oe||(oe=!0,Xe.then(ve))}function ae(n){W.push(n)}function we(n){ue.push(n)}const ce=new Set;let X=0;function ve(){const n=ie;do{for(;X<J.length;){const e=J[X];X++,B(e),et(e.$$)}for(B(null),J.length=0,X=0;Z.length;)Z.pop()();for(let e=0;e<W.length;e+=1){const t=W[e];ce.has(t)||(ce.add(t),t())}W.length=0}while(J.length);for(;ue.length;)ue.pop()();oe=!1,ce.clear(),B(n)}function et(n){if(n.fragment!==null){n.update(),Y(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(ae)}}const K=new Set;let P;function ye(){P={r:0,c:[],p:P}}function Ie(){P.r||Y(P.c),P=P.p}function b(n,e){n&&n.i&&(K.delete(n),n.i(e))}function y(n,e,t,l){if(n&&n.o){if(K.has(n))return;K.add(n),P.c.push(()=>{K.delete(n),l&&(t&&n.d(1),l())}),n.o(e)}else l&&l()}function Me(n,e,t){const l=n.$$.props[e];l!==void 0&&(n.$$.bound[l]=t,t(n.$$.ctx[l]))}function N(n){n&&n.c()}function F(n,e,t,l){const{fragment:r,on_mount:s,on_destroy:i,after_update:o}=n.$$;r&&r.m(e,t),l||ae(()=>{const a=s.map(me).filter(H);i?i.push(...a):Y(a),n.$$.on_mount=[]}),o.forEach(ae)}function S(n,e){const t=n.$$;t.fragment!==null&&(Y(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function tt(n,e){n.$$.dirty[0]===-1&&(J.push(n),Ke(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function C(n,e,t,l,r,s,i,o=[-1]){const a=ie;B(n);const u=n.$$={fragment:null,ctx:null,props:s,update:v,not_equal:r,bound:ge(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:ge(),dirty:o,skip_bound:!1,root:e.target||a.$$.root};i&&i(u.root);let c=!1;if(u.ctx=t?t(n,e.props||{},(d,g,..._)=>{const m=_.length?_[0]:g;return u.ctx&&r(u.ctx[d],u.ctx[d]=m)&&(!u.skip_bound&&u.bound[d]&&u.bound[d](m),c&&tt(n,d)),g}):[],u.update(),c=!0,Y(u.before_update),u.fragment=l?l(u.ctx):!1,e.target){if(e.hydrate){const d=We(e.target);u.fragment&&u.fragment.l(d),d.forEach(I)}else u.fragment&&u.fragment.c();e.intro&&b(n.$$.fragment),F(n,e.target,e.anchor,e.customElement),ve()}B(a)}class j{$destroy(){S(this,1),this.$destroy=v}$on(e,t){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(t),()=>{const r=l.indexOf(t);r!==-1&&l.splice(r,1)}}$set(e){this.$$set&&!Qe(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Vn="",Gn="",nt="A 'merge' property is required",rt="Property 'merge' must be an array",lt="A 'find' property is required on every element inside 'merge'",st="Every 'find' property inside 'merge' must be of type string",it="Every 'find' property inside 'merge' must be a string of length equal to or higher than one",ut="A 'replace' property is required on every element inside 'merge'",ot="Unexpected error while parsing template JSON",at="Every element inside the 'merge' should be an object";var ct=Object.defineProperty,ft=Object.defineProperties,dt=Object.getOwnPropertyDescriptors,Fe=Object.getOwnPropertySymbols,mt=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable,Se=(n,e,t)=>e in n?ct(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,ht=(n,e)=>{for(var t in e||(e={}))mt.call(e,t)&&Se(n,t,e[t]);if(Fe)for(var t of Fe(e))gt.call(e,t)&&Se(n,t,e[t]);return n},pt=(n,e)=>ft(n,dt(e));class L extends Error{constructor(e){super(e)}}function _t(n){return typeof n=="object"}function ee(n,e){return n in e}function fe(n,e){return!ee(n,e)}function bt(n,e){return ee(n,e)&&!(e[n]instanceof Array)}function wt(n,e){return ee(n,e)&&typeof e[n]!="string"}function vt(n,e){const t=ee(n,e)&&e[n];return!(typeof t=="string"&&t.length>0)}function yt(n){try{const e=JSON.parse(n);if(fe("merge",e))throw new L(nt);if(bt("merge",e))throw new L(rt);const{merge:t}=e,l=It(t);return pt(ht({},e),{merge:l})}catch(e){throw Te(e)}}function It(n){return n.map(t=>{if(!_t(t))throw new L(at);if(fe("find",t))throw new L(lt);if(fe("replace",t))throw new L(ut);if(wt("find",t))throw new L(st);if(vt("find",t))throw new L(it);return t}).map(({find:t,replace:l})=>({find:t,replace:Ne(l)}))}function Mt(n){return typeof n=="object"&&n!==null&&"message"in n}function Te(n){return n instanceof Error?n:Mt(n)?new L(n.message):new L(ot)}function Ne(n){return typeof n=="string"?n:JSON.stringify(n)}function de(n){const e=new RegExp("(?<={{).+(?=}})|(?<={{).+(?=}$)|(?<={{).+(?=$)","g"),t=n.match(e);return t&&t.toString().trim()||n}var Ft=Object.defineProperty,St=Object.defineProperties,Tt=Object.getOwnPropertyDescriptors,Ce=Object.getOwnPropertySymbols,Nt=Object.prototype.hasOwnProperty,Ct=Object.prototype.propertyIsEnumerable,je=(n,e,t)=>e in n?Ft(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Q=(n,e)=>{for(var t in e||(e={}))Nt.call(e,t)&&je(n,t,e[t]);if(Ce)for(var t of Ce(e))Ct.call(e,t)&&je(n,t,e[t]);return n},te=(n,e)=>St(n,Tt(e));class Ee{constructor(e){this._error=null,this.template={merge:[]},this._result={merge:[]},this.handlers={change:[],submit:[],error:[this.logger],upload:[]},this.setTemplateSource(e)}set error(e){const t=this._error&&Q({},this._error)||null;this._error=e,e!==null&&this.handlers.error.forEach(l=>l(e,t))}get error(){return this._error}set result(e){this._result=e,this.handlers.change.forEach(t=>t(e))}get result(){return this._result}on(e,t){this.handlers[e].push(t)}off(e,t){this.handlers=te(Q({},this.handlers),{[e]:this.handlers[e].filter(l=>l!==t)})}submit(){if(this.error)throw this.error;this.handlers.submit.forEach(e=>e(this.result))}setTemplateSource(e){try{const t=yt(Ne(e));this.template=t,this.result=t,this.error=null}catch(t){const l=Te(t);this.error=l}}updateResultMergeFields(e,t){const l=t||this.getMergeFieldItem({find:e.find});return this.result.merge.forEach(r=>{r===l&&(r.find=e.find,r.replace=e.replace)}),this.result=te(Q({},this.result),{merge:this.result.merge}),this.result.merge}logger(e){console.error(e)}addMergeField(e){this.setTemplateSource(te(Q({},this.result),{merge:[...this.result.merge,e]}))}removeMergeField(e){this.setTemplateSource(te(Q({},this.result),{merge:this.result.merge.filter(t=>t!==e)}))}getMergeFieldItem(e){if(Object.keys(e).length===0)return;const t=function(l){let r;for(r in e)if(l[r]!==e[r])return!1;return!0};return this.result.merge.find(t)}getSrcPlaceholders(){if(!this.template.timeline||!this.template.timeline.tracks)return[];const e=this.template.timeline.tracks,t=[];for(let l=0;l<e.length;l++)for(let r=0;r<e[l].clips.length;r++){const s={placeholder:e[l].clips[r].asset.src,asset:e[l].clips[r].asset};de(s.placeholder)!==s.placeholder&&t.push(s)}return t}async updateSrc(e,t){let l=t.src;for(let r=0;r<this.handlers.upload.length;r++){const s=this.handlers.upload[r];l=await s(e)}t.src=l,this.handlers.change.forEach(r=>r(this.result))}}const jt={merge:[{find:"NAME",replace:"world"}],timeline:{tracks:[{clips:[{asset:{type:"title",text:"Hello {{ NAME }}",style:"future",src:"{{ ASSET }}"},start:0,length:5}]}]},output:{format:"mp4",resolution:"hd"}},R=[];function De(n,e=v){let t;const l=new Set;function r(o){if(T(n,o)&&(n=o,t)){const a=!R.length;for(const u of l)u[1](),R.push(u,n);if(a){for(let u=0;u<R.length;u+=2)R[u][0](R[u+1]);R.length=0}}}function s(o){r(o(n))}function i(o,a=v){const u=[o,a];return l.add(u),l.size===1&&(t=e(r)||v),o(n),()=>{l.delete(u),l.size===0&&(t(),t=null)}}return{set:r,update:s,subscribe:i}}function Et(n){let e,t,l;return{c(){e=p("input"),f(e,"class","border w-full mb-3 pl-2 py-1 text-stone-500"),f(e,"type","text"),f(e,"role","textbox"),f(e,"aria-label",n[1])},m(r,s){M(r,e,s),be(e,n[0]),t||(l=[A(e,"input",n[3]),A(e,"focus",n[4],{once:!0})],t=!0)},p(r,[s]){s&2&&f(e,"aria-label",r[1]),s&1&&e.value!==r[0]&&be(e,r[0])},i:v,o:v,d(r){r&&I(e),t=!1,Y(l)}}}function Dt(n,e,t){let{value:l}=e,{label:r}=e,{onFocus:s}=e;function i(){l=this.value,t(0,l)}const o=a=>s(a.currentTarget);return n.$$set=a=>{"value"in a&&t(0,l=a.value),"label"in a&&t(1,r=a.label),"onFocus"in a&&t(2,s=a.onFocus)},[l,r,s,i,o]}class Oe extends j{constructor(e){super(),C(this,e,Dt,Et,T,{value:0,label:1,onFocus:2})}}function Ot(n){let e,t,l,r,s,i,o,a,u,c,d,g,_,m,w,D;function k(O){n[7](O)}let U={label:"MergeField.find",onFocus:n[6]};n[1]!==void 0&&(U.value=n[1]),i=new Oe({props:U}),Z.push(()=>Me(i,"value",k));function re(O){n[9](O)}let z={label:"MergeField.replace",onFocus:n[8]};return n[2]!==void 0&&(z.value=n[2]),u=new Oe({props:z}),Z.push(()=>Me(u,"value",re)),{c(){e=p("div"),t=p("div"),l=p("h1"),l.textContent="Add a new merge field",r=E(),s=p("div"),N(i.$$.fragment),a=E(),N(u.$$.fragment),d=E(),g=p("div"),_=p("button"),_.textContent="Add",f(l,"class","text-teal-400 px-1"),f(_,"aria-label","Add field"),f(_,"class","bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 rounded align-self-end"),f(g,"class","flex flex-row-reverse"),f(s,"class","border p-4 mb-6"),f(e,"data-cy","add-merge-field-section")},m(O,le){M(O,e,le),h(e,t),h(t,l),h(t,r),h(t,s),F(i,s,null),h(s,a),F(u,s,null),h(s,d),h(s,g),h(g,_),m=!0,w||(D=A(_,"click",se(n[10])),w=!0)},p(O,[le]){const Re={};!o&&le&2&&(o=!0,Re.value=O[1],we(()=>o=!1)),i.$set(Re);const Ue={};!c&&le&4&&(c=!0,Ue.value=O[2],we(()=>c=!1)),u.$set(Ue)},i(O){m||(b(i.$$.fragment,O),b(u.$$.fragment,O),m=!0)},o(O){y(i.$$.fragment,O),y(u.$$.fragment,O),m=!1},d(O){O&&I(e),S(i),S(u),w=!1,D()}}}function At(n,e,t){let l,r,s=De("find");he(n,s,m=>t(1,l=m));let i=De("replace");he(n,i,m=>t(2,r=m));let o=m=>m.set(""),{addField:a}=e;const u=()=>o(s);function c(m){l=m,s.set(l)}const d=()=>o(i);function g(m){r=m,i.set(r)}const _=()=>a({find:l,replace:r});return n.$$set=m=>{"addField"in m&&t(0,a=m.addField)},[a,l,r,s,i,o,u,c,d,g,_]}class kt extends j{constructor(e){super(),C(this,e,At,Ot,T,{addField:0})}}function Lt(n){let e,t;return{c(){e=G("svg"),t=G("path"),f(t,"fill","white"),f(t,"d","M.293.293a1 1 0 011.414 0L8 6.586 14.293.293a1 1 0 111.414 1.414L9.414 8l6.293 6.293a1 1 0 01-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 01-1.414-1.414L6.586 8 .293 1.707a1 1 0 010-1.414z"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 16 16")},m(l,r){M(l,e,r),h(e,t)},p:v,i:v,o:v,d(l){l&&I(e)}}}function $t(n){return[]}class xt extends j{constructor(e){super(),C(this,e,$t,Lt,T,{})}}function Pt(n){let e,t,l,r,s;return t=new xt({}),{c(){e=p("button"),N(t.$$.fragment),f(e,"class","bg-blue-400 hover:bg-blue-700 text-white font-bold absolute top-0 right-0 rounded-full w-4 h-4 p-1"),f(e,"aria-label","Remove field")},m(i,o){M(i,e,o),F(t,e,null),l=!0,r||(s=A(e,"click",se(function(){H(n[0])&&n[0].apply(this,arguments)})),r=!0)},p(i,[o]){n=i},i(i){l||(b(t.$$.fragment,i),l=!0)},o(i){y(t.$$.fragment,i),l=!1},d(i){i&&I(e),S(t),r=!1,s()}}}function zt(n,e,t){let{onClick:l}=e;return n.$$set=r=>{"onClick"in r&&t(0,l=r.onClick)},[l]}class Yt extends j{constructor(e){super(),C(this,e,zt,Pt,T,{onClick:0})}}function Rt(n){let e,t;return{c(){e=p("label"),t=$(n[0]),f(e,"for",n[0]),f(e,"class","block mb-2 monospace")},m(l,r){M(l,e,r),h(e,t)},p(l,[r]){r&1&&q(t,l[0]),r&1&&f(e,"for",l[0])},i:v,o:v,d(l){l&&I(e)}}}function Ut(n,e,t){let{find:l}=e;return n.$$set=r=>{"find"in r&&t(0,l=r.find)},[l]}class Bt extends j{constructor(e){super(),C(this,e,Ut,Rt,T,{find:0})}}function Jt(n){let e,t,l;return{c(){e=p("input"),f(e,"role","textbox"),f(e,"class","border w-full mb-3 pl-2 py-1 text-stone-500"),f(e,"type","text"),e.value=n[2],f(e,"label",n[1])},m(r,s){M(r,e,s),t||(l=A(e,"input",n[4]),t=!0)},p(r,[s]){s&4&&e.value!==r[2]&&(e.value=r[2]),s&2&&f(e,"label",r[1])},i:v,o:v,d(r){r&&I(e),t=!1,l()}}}function Qt(n,e,t){let{field:l}=e,{find:r}=e,{replace:s}=e,{handleFormInput:i}=e;const o=a=>i({find:r,replace:a.currentTarget.value},l);return n.$$set=a=>{"field"in a&&t(0,l=a.field),"find"in a&&t(1,r=a.find),"replace"in a&&t(2,s=a.replace),"handleFormInput"in a&&t(3,i=a.handleFormInput)},[l,r,s,i,o]}class Ht extends j{constructor(e){super(),C(this,e,Qt,Jt,T,{field:0,find:1,replace:2,handleFormInput:3})}}function Vt(n){let e,t,l,r,s;return t=new Bt({props:{find:n[0].find}}),r=new Ht({props:{find:n[0].find,replace:n[0].replace,field:n[0],handleFormInput:n[1]}}),{c(){e=p("div"),N(t.$$.fragment),l=E(),N(r.$$.fragment),f(e,"data-cy","label-input")},m(i,o){M(i,e,o),F(t,e,null),h(e,l),F(r,e,null),s=!0},p(i,[o]){const a={};o&1&&(a.find=i[0].find),t.$set(a);const u={};o&1&&(u.find=i[0].find),o&1&&(u.replace=i[0].replace),o&1&&(u.field=i[0]),o&2&&(u.handleFormInput=i[1]),r.$set(u)},i(i){s||(b(t.$$.fragment,i),b(r.$$.fragment,i),s=!0)},o(i){y(t.$$.fragment,i),y(r.$$.fragment,i),s=!1},d(i){i&&I(e),S(t),S(r)}}}function Gt(n,e,t){let{field:l}=e,{handleFormInput:r}=e;return n.$$set=s=>{"field"in s&&t(0,l=s.field),"handleFormInput"in s&&t(1,r=s.handleFormInput)},[l,r]}class Ae extends j{constructor(e){super(),C(this,e,Gt,Vt,T,{field:0,handleFormInput:1})}}function ke(n,e,t){const l=n.slice();return l[6]=e[t],l}function Le(n){let e,t,l,r,s,i;t=new Ae({props:{field:n[6],handleFormInput:n[2]}});function o(){return n[5](n[6])}return r=new Yt({props:{onClick:o}}),{c(){e=p("div"),N(t.$$.fragment),l=E(),N(r.$$.fragment),s=E(),f(e,"class","relative")},m(a,u){M(a,e,u),F(t,e,null),h(e,l),F(r,e,null),h(e,s),i=!0},p(a,u){n=a;const c={};u&2&&(c.field=n[6]),u&4&&(c.handleFormInput=n[2]),t.$set(c);const d={};u&18&&(d.onClick=o),r.$set(d)},i(a){i||(b(t.$$.fragment,a),b(r.$$.fragment,a),i=!0)},o(a){y(t.$$.fragment,a),y(r.$$.fragment,a),i=!1},d(a){a&&I(e),S(t),S(r)}}}function qt(n){let e,t,l,r,s,i,o,a,u=n[1],c=[];for(let g=0;g<u.length;g+=1)c[g]=Le(ke(n,u,g));const d=g=>y(c[g],1,1,()=>{c[g]=null});return o=new kt({props:{addField:n[3]}}),{c(){e=p("div"),t=p("div"),l=p("h1"),l.textContent="Modify Merge Values",r=E(),s=p("div");for(let g=0;g<c.length;g+=1)c[g].c();i=E(),N(o.$$.fragment),f(l,"class","text-teal-400 px-1"),f(s,"class","border p-4 mb-6"),f(t,"data-cy","merge-fields-input-section"),x(e,"hidden",n[0])},m(g,_){M(g,e,_),h(e,t),h(t,l),h(t,r),h(t,s);for(let m=0;m<c.length;m+=1)c[m].m(s,null);h(e,i),F(o,e,null),a=!0},p(g,[_]){if(_&22){u=g[1];let w;for(w=0;w<u.length;w+=1){const D=ke(g,u,w);c[w]?(c[w].p(D,_),b(c[w],1)):(c[w]=Le(D),c[w].c(),b(c[w],1),c[w].m(s,null))}for(ye(),w=u.length;w<c.length;w+=1)d(w);Ie()}const m={};_&8&&(m.addField=g[3]),o.$set(m),(!a||_&1)&&x(e,"hidden",g[0])},i(g){if(!a){for(let _=0;_<u.length;_+=1)b(c[_]);b(o.$$.fragment,g),a=!0}},o(g){c=c.filter(Boolean);for(let _=0;_<c.length;_+=1)y(c[_]);y(o.$$.fragment,g),a=!1},d(g){g&&I(e),_e(c,g),S(o)}}}function Zt(n,e,t){let{error:l}=e,{fields:r=[]}=e,{handleFormInput:s}=e,{addField:i}=e,{removeField:o}=e;const a=u=>o(u);return n.$$set=u=>{"error"in u&&t(0,l=u.error),"fields"in u&&t(1,r=u.fields),"handleFormInput"in u&&t(2,s=u.handleFormInput),"addField"in u&&t(3,i=u.addField),"removeField"in u&&t(4,o=u.removeField)},[l,r,s,i,o,a]}class Wt extends j{constructor(e){super(),C(this,e,Zt,qt,T,{error:0,fields:1,handleFormInput:2,addField:3,removeField:4})}}function Xt(n){let e,t,l;return{c(){e=p("button"),e.textContent="Reset",f(e,"class","bg-blue-500 hover:bg-blue-700 text-white font-bold py-1 px-3 rounded align-self-end")},m(r,s){M(r,e,s),t||(l=A(e,"click",se(function(){H(n[0])&&n[0].apply(this,arguments)})),t=!0)},p(r,[s]){n=r},i:v,o:v,d(r){r&&I(e),t=!1,l()}}}function Kt(n,e,t){let{onClick:l}=e;return n.$$set=r=>{"onClick"in r&&t(0,l=r.onClick)},[l]}class en extends j{constructor(e){super(),C(this,e,Kt,Xt,T,{onClick:0})}}function tn(n){let e,t,l,r,s,i,o,a;return o=new en({props:{onClick:n[0]}}),{c(){e=p("div"),t=p("p"),l=p("span"),r=$(n[2]),s=E(),i=p("div"),N(o.$$.fragment),f(l,"class","monospace text-orange-900"),f(t,"data-cy","template-input-error"),f(t,"class","bg-rose-200 rounded py-2 my-4 px-4"),f(i,"class","flex flex-row-reverse "),f(e,"data-cy","error-container"),x(e,"hidden",!n[1])},m(u,c){M(u,e,c),h(e,t),h(t,l),h(l,r),h(e,s),h(e,i),F(o,i,null),a=!0},p(u,[c]){(!a||c&4)&&q(r,u[2]);const d={};c&1&&(d.onClick=u[0]),o.$set(d),(!a||c&2)&&x(e,"hidden",!u[1])},i(u){a||(b(o.$$.fragment,u),a=!0)},o(u){y(o.$$.fragment,u),a=!1},d(u){u&&I(e),S(o)}}}function nn(n,e,t){let l,{onClick:r}=e,{error:s}=e;return n.$$set=i=>{"onClick"in i&&t(0,r=i.onClick),"error"in i&&t(1,s=i.error)},n.$$.update=()=>{n.$$.dirty&2&&t(2,l=s&&s.message||"")},[r,s,l]}class rn extends j{constructor(e){super(),C(this,e,nn,tn,T,{onClick:0,error:1})}}const $e=(n,e)=>async t=>await e(t,n);function ln(n){let e,t,l=de(n[1])+"",r,s,i,o,a,u,c;return{c(){e=p("div"),t=p("label"),r=$(l),s=E(),i=p("input"),o=E(),a=p("input"),f(t,"class","block mb-2 monospace"),f(t,"for","input"),f(i,"aria-label","Current source value"),f(i,"class","border w-full mb-3 pl-2 py-1 text-stone-500"),f(i,"type","text"),i.value=n[0],i.disabled=!0,a.disabled=n[2],f(a,"role","button"),f(a,"aria-label","File upload"),f(a,"class","border w-full mb-3 pl-2 py-1 text-stone-500"),f(a,"type","file"),f(e,"data-cy","source-input")},m(d,g){M(d,e,g),h(e,t),h(t,r),h(e,s),h(e,i),h(e,o),h(e,a),u||(c=A(a,"change",n[7]),u=!0)},p(d,[g]){g&2&&l!==(l=de(d[1])+"")&&q(r,l),g&1&&i.value!==d[0]&&(i.value=d[0]),g&4&&(a.disabled=d[2])},i:v,o:v,d(d){d&&I(e),u=!1,c()}}}function sn(n,e,t){let l,{asset:r}=e,{value:s}=e,{label:i}=e,{handleChange:o}=e,a=!1,u=async d=>{t(6,a=!0),await o(d),t(0,s=r.src),t(6,a=!1)};const c=d=>u(d.currentTarget.files);return n.$$set=d=>{"asset"in d&&t(4,r=d.asset),"value"in d&&t(0,s=d.value),"label"in d&&t(1,i=d.label),"handleChange"in d&&t(5,o=d.handleChange)},n.$$.update=()=>{n.$$.dirty&64&&t(2,l=a)},[s,i,l,u,r,o,a,c]}class xe extends j{constructor(e){super(),C(this,e,sn,ln,T,{asset:4,value:0,label:1,handleChange:5})}}function Pe(n,e,t){const l=n.slice();return l[2]=e[t],l}function ze(n){let e,t;return e=new xe({props:{label:n[2].placeholder,handleChange:$e(n[2].asset,n[1]),value:n[2].asset.src,asset:n[2].asset}}),{c(){N(e.$$.fragment)},m(l,r){F(e,l,r),t=!0},p(l,r){const s={};r&1&&(s.label=l[2].placeholder),r&3&&(s.handleChange=$e(l[2].asset,l[1])),r&1&&(s.value=l[2].asset.src),r&1&&(s.asset=l[2].asset),e.$set(s)},i(l){t||(b(e.$$.fragment,l),t=!0)},o(l){y(e.$$.fragment,l),t=!1},d(l){S(e,l)}}}function un(n){let e,t,l,r,s,i=n[0],o=[];for(let u=0;u<i.length;u+=1)o[u]=ze(Pe(n,i,u));const a=u=>y(o[u],1,1,()=>{o[u]=null});return{c(){e=p("div"),t=p("h1"),t.textContent="Update sources",l=E(),r=p("div");for(let u=0;u<o.length;u+=1)o[u].c();f(t,"class","text-teal-400 px-1"),f(r,"class","border p-4 mb-6"),f(e,"data-cy","source-container"),x(e,"hidden",n[0].length<1)},m(u,c){M(u,e,c),h(e,t),h(e,l),h(e,r);for(let d=0;d<o.length;d+=1)o[d].m(r,null);s=!0},p(u,[c]){if(c&3){i=u[0];let d;for(d=0;d<i.length;d+=1){const g=Pe(u,i,d);o[d]?(o[d].p(g,c),b(o[d],1)):(o[d]=ze(g),o[d].c(),b(o[d],1),o[d].m(r,null))}for(ye(),d=i.length;d<o.length;d+=1)a(d);Ie()}(!s||c&1)&&x(e,"hidden",u[0].length<1)},i(u){if(!s){for(let c=0;c<i.length;c+=1)b(o[c]);s=!0}},o(u){o=o.filter(Boolean);for(let c=0;c<o.length;c+=1)y(o[c]);s=!1},d(u){u&&I(e),_e(o,u)}}}function on(n,e,t){let{sources:l}=e,{handleSourceFieldUpdate:r}=e;return n.$$set=s=>{"sources"in s&&t(0,l=s.sources),"handleSourceFieldUpdate"in s&&t(1,r=s.handleSourceFieldUpdate)},[l,r]}class an extends j{constructor(e){super(),C(this,e,on,un,T,{sources:0,handleSourceFieldUpdate:1})}}function cn(n){let e,t;const l=n[1].default,r=Ve(l,n,n[0],null);return{c(){e=p("label"),r&&r.c(),f(e,"for","json-input"),f(e,"class","text-teal-400 px-1")},m(s,i){M(s,e,i),r&&r.m(e,null),t=!0},p(s,[i]){r&&r.p&&(!t||i&1)&&qe(r,l,s,s[0],t?Ge(l,s[0],i,null):Ze(s[0]),null)},i(s){t||(b(r,s),t=!0)},o(s){y(r,s),t=!1},d(s){s&&I(e),r&&r.d(s)}}}function fn(n,e,t){let{$$slots:l={},$$scope:r}=e;return n.$$set=s=>{"$$scope"in s&&t(0,r=s.$$scope)},[r,l]}class Ye extends j{constructor(e){super(),C(this,e,fn,cn,T,{})}}function ne(n){return JSON.stringify(n,null,2)}function dn(n){let e,t,l,r;return{c(){e=p("textarea"),f(e,"data-cy","template-input"),f(e,"class","w-full h-60 monospace border p-4 overflow-auto whitespace-pre resize-none"),f(e,"id","json-input"),e.value=t=ne(n[1])},m(s,i){M(s,e,i),l||(r=A(e,"input",n[2]),l=!0)},p(s,[i]){i&2&&t!==(t=ne(s[1]))&&(e.value=t)},i:v,o:v,d(s){s&&I(e),l=!1,r()}}}function mn(n,e,t){let{handleTemplateInput:l}=e,{template:r}=e;const s=i=>l(i.currentTarget.value);return n.$$set=i=>{"handleTemplateInput"in i&&t(0,l=i.handleTemplateInput),"template"in i&&t(1,r=i.template)},[l,r,s]}class gn extends j{constructor(e){super(),C(this,e,mn,dn,T,{handleTemplateInput:0,template:1})}}function hn(n){let e;return{c(){e=$("Paste template")},m(t,l){M(t,e,l)},d(t){t&&I(e)}}}function pn(n){let e,t,l,r,s;return t=new Ye({props:{$$slots:{default:[hn]},$$scope:{ctx:n}}}),r=new gn({props:{template:n[0],handleTemplateInput:n[1]}}),{c(){e=p("div"),N(t.$$.fragment),l=E(),N(r.$$.fragment),f(e,"data-cy","template-input-section"),f(e,"class","mb-6")},m(i,o){M(i,e,o),F(t,e,null),h(e,l),F(r,e,null),s=!0},p(i,[o]){const a={};o&4&&(a.$$scope={dirty:o,ctx:i}),t.$set(a);const u={};o&1&&(u.template=i[0]),o&2&&(u.handleTemplateInput=i[1]),r.$set(u)},i(i){s||(b(t.$$.fragment,i),b(r.$$.fragment,i),s=!0)},o(i){y(t.$$.fragment,i),y(r.$$.fragment,i),s=!1},d(i){i&&I(e),S(t),S(r)}}}function _n(n,e,t){let{template:l}=e,{handleTemplateInput:r}=e;return n.$$set=s=>{"template"in s&&t(0,l=s.template),"handleTemplateInput"in s&&t(1,r=s.handleTemplateInput)},[l,r]}class bn extends j{constructor(e){super(),C(this,e,_n,pn,T,{template:0,handleTemplateInput:1})}}function wn(n){let e,t;return{c(){e=G("svg"),t=G("path"),f(t,"d","M13 8V2H7v6H2l8 8 8-8h-5zM0 18h20v2H0v-2z"),f(e,"class","fill-current w-4 h-4 mr-2"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"viewBox","0 0 20 20")},m(l,r){M(l,e,r),h(e,t)},p:v,i:v,o:v,d(l){l&&I(e)}}}function vn(n){return[]}class yn extends j{constructor(e){super(),C(this,e,vn,wn,T,{})}}function In(n){let e,t,l,r;return t=new yn({}),{c(){e=p("a"),N(t.$$.fragment),l=$(`
	Download`),f(e,"href",n[0]),f(e,"download","result.json"),f(e,"class","bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded inline-flex items-center w-40 justify-center")},m(s,i){M(s,e,i),F(t,e,null),h(e,l),r=!0},p(s,[i]){(!r||i&1)&&f(e,"href",s[0])},i(s){r||(b(t.$$.fragment,s),r=!0)},o(s){y(t.$$.fragment,s),r=!1},d(s){s&&I(e),S(t)}}}function Mn(n,e,t){let{download:l=""}=e;return n.$$set=r=>{"download"in r&&t(0,l=r.download)},[l]}class Fn extends j{constructor(e){super(),C(this,e,Mn,In,T,{download:0})}}function Sn(n){let e,t,l;return{c(){e=p("button"),e.textContent="Submit",f(e,"class","bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded w-40")},m(r,s){M(r,e,s),t||(l=A(e,"click",function(){H(n[0])&&n[0].apply(this,arguments)}),t=!0)},p(r,[s]){n=r},i:v,o:v,d(r){r&&I(e),t=!1,l()}}}function Tn(n,e,t){let{submit:l}=e;return n.$$set=r=>{"submit"in r&&t(0,l=r.submit)},[l]}class Nn extends j{constructor(e){super(),C(this,e,Tn,Sn,T,{submit:0})}}function Cn(n){let e,t,l,r,s;return t=new Fn({props:{download:n[0]}}),r=new Nn({props:{submit:n[1]}}),{c(){e=p("div"),N(t.$$.fragment),l=E(),N(r.$$.fragment),f(e,"class","flex justify-between pt-4")},m(i,o){M(i,e,o),F(t,e,null),h(e,l),F(r,e,null),s=!0},p(i,[o]){const a={};o&1&&(a.download=i[0]),t.$set(a);const u={};o&2&&(u.submit=i[1]),r.$set(u)},i(i){s||(b(t.$$.fragment,i),b(r.$$.fragment,i),s=!0)},o(i){y(t.$$.fragment,i),y(r.$$.fragment,i),s=!1},d(i){i&&I(e),S(t),S(r)}}}function jn(n,e,t){let{download:l=""}=e,{submit:r}=e;return n.$$set=s=>{"download"in s&&t(0,l=s.download),"submit"in s&&t(1,r=s.submit)},[l,r]}class En extends j{constructor(e){super(),C(this,e,jn,Cn,T,{download:0,submit:1})}}function Dn(n){navigator.clipboard.writeText(JSON.stringify(n)),alert("JSON copied to clipboard!")}const On="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MS4yIDUxLjIiIHdpZHRoPSI1MS4yIiBoZWlnaHQ9IjUxLjIiID4KICAgIDxzdmcgd2lkdGg9IjUxLjIiIGhlaWdodD0iNTEuMiIgdmlld0JveD0iMCAwIDUxMiA1MTIiPgogICAgICAgIDxwYXRoCiAgICAgICAgICAgIGQ9Ik01MDIuNiA3MC42M2wtNjEuMjUtNjEuMjVDNDM1LjQgMy4zNzEgNDI3LjIgMCA0MTguNyAwSDI1NS4xYy0zNS4zNSAwLTY0IDI4LjY2LTY0IDY0bC4wMTk1IDI1NkMxOTIgMzU1LjQgMjIwLjcgMzg0IDI1NiAzODRoMTkyYzM1LjIgMCA2NC0yOC44IDY0LTY0VjkzLjI1QzUxMiA4NC43NyA1MDguNiA3Ni42MyA1MDIuNiA3MC42M3pNNDY0IDMyMGMwIDguODM2LTcuMTY0IDE2LTE2IDE2SDI1NS4xYy04LjgzOCAwLTE2LTcuMTY0LTE2LTE2TDIzOS4xIDY0LjEzYzAtOC44MzYgNy4xNjQtMTYgMTYtMTZoMTI4TDM4NCA5NmMwIDE3LjY3IDE0LjMzIDMyIDMyIDMyaDQ3LjFWMzIwek0yNzIgNDQ4YzAgOC44MzYtNy4xNjQgMTYtMTYgMTZINjMuMWMtOC44MzggMC0xNi03LjE2NC0xNi0xNkw0Ny45OCAxOTIuMWMwLTguODM2IDcuMTY0LTE2IDE2LTE2SDE2MFYxMjhINjMuOTljLTM1LjM1IDAtNjQgMjguNjUtNjQgNjRsLjAwOTggMjU2Qy4wMDIgNDgzLjMgMjguNjYgNTEyIDY0IDUxMmgxOTJjMzUuMiAwIDY0LTI4LjggNjQtNjR2LTMyaC00Ny4xTDI3MiA0NDh6IiAvPgogICAgPC9zdmc+Cjwvc3ZnPg==";function An(n){let e,t,l,r,s;return{c(){e=p("abbr"),t=p("img"),Je(t.src,l=On)||f(t,"src",l),f(t,"alt","copy-button"),f(t,"class","h-4 cursor-pointer inline mb-1"),f(e,"title","Copy to clipboard")},m(i,o){M(i,e,o),h(e,t),r||(s=A(t,"click",Dn),r=!0)},p:v,i:v,o:v,d(i){i&&I(e),r=!1,s()}}}class kn extends j{constructor(e){super(),C(this,e,null,An,T,{})}}function Ln(n){let e,t;return{c(){e=p("p"),t=$(n[0]),f(e,"data-cy","result"),f(e,"class","h-60 overflow-auto border p-4 whitespace-pre monospace")},m(l,r){M(l,e,r),h(e,t)},p(l,[r]){r&1&&q(t,l[0])},i:v,o:v,d(l){l&&I(e)}}}function $n(n,e,t){let{text:l}=e;return n.$$set=r=>{"text"in r&&t(0,l=r.text)},[l]}class xn extends j{constructor(e){super(),C(this,e,$n,Ln,T,{text:0})}}function Pn(n){let e;return{c(){e=$("Result")},m(t,l){M(t,e,l)},d(t){t&&I(e)}}}function zn(n){let e,t,l,r,s,i,o,a,u;return t=new Ye({props:{$$slots:{default:[Pn]},$$scope:{ctx:n}}}),r=new kn({}),i=new xn({props:{text:ne(n[0])}}),a=new En({props:{submit:n[2],download:n[1]}}),{c(){e=p("div"),N(t.$$.fragment),l=E(),N(r.$$.fragment),s=E(),N(i.$$.fragment),o=E(),N(a.$$.fragment),f(e,"data-cy","result-section"),x(e,"hidden",n[3])},m(c,d){M(c,e,d),F(t,e,null),h(e,l),F(r,e,null),h(e,s),F(i,e,null),h(e,o),F(a,e,null),u=!0},p(c,[d]){const g={};d&16&&(g.$$scope={dirty:d,ctx:c}),t.$set(g);const _={};d&1&&(_.text=ne(c[0])),i.$set(_);const m={};d&4&&(m.submit=c[2]),d&2&&(m.download=c[1]),a.$set(m),(!u||d&8)&&x(e,"hidden",c[3])},i(c){u||(b(t.$$.fragment,c),b(r.$$.fragment,c),b(i.$$.fragment,c),b(a.$$.fragment,c),u=!0)},o(c){y(t.$$.fragment,c),y(r.$$.fragment,c),y(i.$$.fragment,c),y(a.$$.fragment,c),u=!1},d(c){c&&I(e),S(t),S(r),S(i),S(a)}}}function Yn(n,e,t){let{result:l}=e,{download:r}=e,{submit:s}=e,{error:i}=e;return n.$$set=o=>{"result"in o&&t(0,l=o.result),"download"in o&&t(1,r=o.download),"submit"in o&&t(2,s=o.submit),"error"in o&&t(3,i=o.error)},[l,r,s,i]}class Rn extends j{constructor(e){super(),C(this,e,Yn,zn,T,{result:0,download:1,submit:2,error:3})}}const Xn="";function Un(n){let e,t,l,r,s,i,o,a,u,c,d,g,_;return r=new bn({props:{template:n[1],handleTemplateInput:n[5]}}),i=new rn({props:{error:n[2],onClick:n[10]}}),a=new Wt({props:{fields:n[0].merge,handleFormInput:n[6],addField:n[8],removeField:n[9],error:n[2]}}),c=new an({props:{sources:n[3],handleSourceFieldUpdate:n[11]}}),g=new Rn({props:{submit:n[7],download:n[4],result:n[0],error:n[2]}}),{c(){e=p("div"),t=p("section"),l=p("form"),N(r.$$.fragment),s=E(),N(i.$$.fragment),o=E(),N(a.$$.fragment),u=E(),N(c.$$.fragment),d=E(),N(g.$$.fragment),f(l,"class","svelte-r93edu"),f(t,"data-cy","form-container"),f(t,"class","max-w-lg my-4 mx-auto border rounded-xl px-7 py-4 svelte-r93edu"),f(e,"class","shotstack-mergefield-form svelte-r93edu")},m(m,w){M(m,e,w),h(e,t),h(t,l),F(r,l,null),h(l,s),F(i,l,null),h(l,o),F(a,l,null),h(l,u),F(c,l,null),h(t,d),F(g,t,null),_=!0},p(m,[w]){const D={};w&2&&(D.template=m[1]),r.$set(D);const k={};w&4&&(k.error=m[2]),i.$set(k);const U={};w&1&&(U.fields=m[0].merge),w&4&&(U.error=m[2]),a.$set(U);const re={};w&8&&(re.sources=m[3]),c.$set(re);const z={};w&16&&(z.download=m[4]),w&1&&(z.result=m[0]),w&4&&(z.error=m[2]),g.$set(z)},i(m){_||(b(r.$$.fragment,m),b(i.$$.fragment,m),b(a.$$.fragment,m),b(c.$$.fragment,m),b(g.$$.fragment,m),_=!0)},o(m){y(r.$$.fragment,m),y(i.$$.fragment,m),y(a.$$.fragment,m),y(c.$$.fragment,m),y(g.$$.fragment,m),_=!1},d(m){m&&I(e),S(r),S(i),S(a),S(c),S(g)}}}function Bn(n){if(typeof window<"u"){const e=new Blob([JSON.stringify(n,null,2)],{type:"text/plain"});return URL.createObjectURL(e)}else return null}function Jn(n,e,t){let l,{editTemplateService:r=new Ee(jt)}=e,s=r.template,i=r.result,o=null,a=r.getSrcPlaceholders();function u(D){r.setTemplateSource(D),t(1,s=r.template),t(0,i=r.result),t(2,o=r.error),t(3,a=r.getSrcPlaceholders())}function c(D,k){r.updateResultMergeFields(D,k),t(0,i=r.result)}function d(){r.submit(),window.alert("Form successfully submitted!")}function g(D){r.addMergeField(D),t(1,s=r.template),t(0,i=r.result),t(2,o=r.error)}function _(D){const k=r.getMergeFieldItem(D);r.removeMergeField(k),t(1,s=r.template),t(0,i=r.result),t(2,o=r.error)}function m(){r.setTemplateSource(r.result),t(1,s=r.template),t(0,i=r.result),t(2,o=r.error)}async function w(D,k){await r.updateSrc(D,k),t(1,s=r.template),t(0,i=r.result)}return n.$$set=D=>{"editTemplateService"in D&&t(12,r=D.editTemplateService)},n.$$.update=()=>{n.$$.dirty&1&&t(4,l=Bn(i)||"")},[i,s,o,a,l,u,c,d,g,_,m,w,r]}class Qn extends j{constructor(e){super(),C(this,e,Jn,Un,T,{editTemplateService:12})}}class Hn{constructor(e){this.templateService=new Ee(e),this.container=void 0}on(e,t){this.templateService.on(e,t)}off(e,t){this.templateService.off(e,t)}submit(){this.templateService.submit()}renderForm(e){this.container=e,new Qn({target:e,props:{editTemplateService:this.templateService}})}renderElements(e,t){const l=this.getInputs();t?t.after(...l):e.append(...l)}display(){this.container&&(this.container.style.display="block")}hide(){this.container&&(this.container.style.display="none")}attach(e){this.remove(),this.container=e,this.renderForm(this.container)}remove(){this.container&&this.container.replaceChildren()}merge(){return this.templateService.result}load(e){this.templateService.setTemplateSource(e)}addField(e,t){this.templateService.addMergeField({find:e,replace:t})}removeField(e){this.templateService.removeMergeField(e)}getField(e){return this.templateService.getMergeFieldItem(e)}getInputs(){const e=document.createElement("div");return this.renderMergeFields(e),this.renderSourceFields(e),e.children}renderMergeFields(e){this.templateService.template.merge.forEach(t=>new Ae({target:e,props:{field:t,handleFormInput:l=>{this.templateService.updateResultMergeFields(l,t)}}}))}renderSourceFields(e){this.templateService.getSrcPlaceholders().forEach(t=>new xe({target:e,props:{value:t.asset.src,asset:t.asset,label:t.placeholder,handleChange:async l=>{await this.templateService.updateSrc(l,t.asset)}}}))}}return Hn}();
