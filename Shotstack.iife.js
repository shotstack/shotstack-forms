var Shotstack=function(){"use strict";var et=Object.defineProperty;var tt=(I,A,j)=>A in I?et(I,A,{enumerable:!0,configurable:!0,writable:!0,value:j}):I[A]=j;var L=(I,A,j)=>(tt(I,typeof A!="symbol"?A+"":A,j),j);function I(){}function A(t){return t()}function j(){return Object.create(null)}function U(t){t.forEach(A)}function de(t){return typeof t=="function"}function he(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let $;function me(t,e){return $||($=document.createElement("a")),$.href=e,t===$.href}function pe(t){return Object.keys(t).length===0}let P=!1;function _e(){P=!0}function ge(){P=!1}function ye(t,e,r,n){for(;t<e;){const c=t+(e-t>>1);r(c)<=n?t=c+1:e=c}return t}function ve(t){if(t.hydrate_init)return;t.hydrate_init=!0;let e=t.childNodes;if(t.nodeName==="HEAD"){const l=[];for(let a=0;a<e.length;a++){const u=e[a];u.claim_order!==void 0&&l.push(u)}e=l}const r=new Int32Array(e.length+1),n=new Int32Array(e.length);r[0]=-1;let c=0;for(let l=0;l<e.length;l++){const a=e[l].claim_order,u=(c>0&&e[r[c]].claim_order<=a?c+1:ye(1,c,p=>e[r[p]].claim_order,a))-1;n[l]=r[u]+1;const m=u+1;r[m]=l,c=Math.max(m,c)}const o=[],i=[];let s=e.length-1;for(let l=r[c]+1;l!=0;l=n[l-1]){for(o.push(e[l-1]);s>=l;s--)i.push(e[s]);s--}for(;s>=0;s--)i.push(e[s]);o.reverse(),i.sort((l,a)=>l.claim_order-a.claim_order);for(let l=0,a=0;l<i.length;l++){for(;a<o.length&&i[l].claim_order>=o[a].claim_order;)a++;const u=a<o.length?o[a]:null;t.insertBefore(i[l],u)}}function _(t,e){if(P){for(ve(t),(t.actual_end_child===void 0||t.actual_end_child!==null&&t.actual_end_child.parentNode!==t)&&(t.actual_end_child=t.firstChild);t.actual_end_child!==null&&t.actual_end_child.claim_order===void 0;)t.actual_end_child=t.actual_end_child.nextSibling;e!==t.actual_end_child?(e.claim_order!==void 0||e.parentNode!==t)&&t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling}else(e.parentNode!==t||e.nextSibling!==null)&&t.appendChild(e)}function O(t,e,r){P&&!r?_(t,e):(e.parentNode!==t||e.nextSibling!=r)&&t.insertBefore(e,r||null)}function g(t){t.parentNode.removeChild(t)}function Ne(t,e){for(let r=0;r<t.length;r+=1)t[r]&&t[r].d(e)}function N(t){return document.createElement(t)}function C(t){return document.createTextNode(t)}function D(){return C(" ")}function G(t,e,r,n){return t.addEventListener(e,r,n),()=>t.removeEventListener(e,r,n)}function h(t,e,r){r==null?t.removeAttribute(e):t.getAttribute(e)!==r&&t.setAttribute(e,r)}function b(t){return Array.from(t.childNodes)}function Ee(t){t.claim_info===void 0&&(t.claim_info={last_index:0,total_claimed:0})}function K(t,e,r,n,c=!1){Ee(t);const o=(()=>{for(let i=t.claim_info.last_index;i<t.length;i++){const s=t[i];if(e(s)){const l=r(s);return l===void 0?t.splice(i,1):t[i]=l,c||(t.claim_info.last_index=i),s}}for(let i=t.claim_info.last_index-1;i>=0;i--){const s=t[i];if(e(s)){const l=r(s);return l===void 0?t.splice(i,1):t[i]=l,c?l===void 0&&t.claim_info.last_index--:t.claim_info.last_index=i,s}}return n()})();return o.claim_order=t.claim_info.total_claimed,t.claim_info.total_claimed+=1,o}function be(t,e,r,n){return K(t,c=>c.nodeName===e,c=>{const o=[];for(let i=0;i<c.attributes.length;i++){const s=c.attributes[i];r[s.name]||o.push(s.name)}o.forEach(i=>c.removeAttribute(i))},()=>n(e))}function E(t,e,r){return be(t,e,r,N)}function k(t,e){return K(t,r=>r.nodeType===3,r=>{const n=""+e;if(r.data.startsWith(n)){if(r.data.length!==n.length)return r.splitText(n.length)}else r.data=n},()=>C(e),!0)}function S(t){return k(t," ")}function H(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}let V;function z(t){V=t}const Y=[],ee=[],B=[],te=[],Me=Promise.resolve();let Q=!1;function Te(){Q||(Q=!0,Me.then(re))}function W(t){B.push(t)}const q=new Set;let F=0;function re(){const t=V;do{for(;F<Y.length;){const e=Y[F];F++,z(e),Ie(e.$$)}for(z(null),Y.length=0,F=0;ee.length;)ee.pop()();for(let e=0;e<B.length;e+=1){const r=B[e];q.has(r)||(q.add(r),r())}B.length=0}while(Y.length);for(;te.length;)te.pop()();Q=!1,q.clear(),z(t)}function Ie(t){if(t.fragment!==null){t.update(),U(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(W)}}const Ae=new Set;function De(t,e){t&&t.i&&(Ae.delete(t),t.i(e))}function Se(t,e,r,n){const{fragment:c,on_mount:o,on_destroy:i,after_update:s}=t.$$;c&&c.m(e,r),n||W(()=>{const l=o.map(A).filter(de);i?i.push(...l):U(l),t.$$.on_mount=[]}),s.forEach(W)}function we(t,e){const r=t.$$;r.fragment!==null&&(U(r.on_destroy),r.fragment&&r.fragment.d(e),r.on_destroy=r.fragment=null,r.ctx=[])}function xe(t,e){t.$$.dirty[0]===-1&&(Y.push(t),Te(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function je(t,e,r,n,c,o,i,s=[-1]){const l=V;z(t);const a=t.$$={fragment:null,ctx:null,props:o,update:I,not_equal:c,bound:j(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:j(),dirty:s,skip_bound:!1,root:e.target||l.$$.root};i&&i(a.root);let u=!1;if(a.ctx=r?r(t,e.props||{},(m,p,...M)=>{const d=M.length?M[0]:p;return a.ctx&&c(a.ctx[m],a.ctx[m]=d)&&(!a.skip_bound&&a.bound[m]&&a.bound[m](d),u&&xe(t,m)),p}):[],a.update(),u=!0,U(a.before_update),a.fragment=n?n(a.ctx):!1,e.target){if(e.hydrate){_e();const m=b(e.target);a.fragment&&a.fragment.l(m),m.forEach(g)}else a.fragment&&a.fragment.c();e.intro&&De(t.$$.fragment),Se(t,e.target,e.anchor,e.customElement),ge(),re()}z(l)}class Ce{$destroy(){we(this,1),this.$destroy=I}$on(e,r){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(r),()=>{const c=n.indexOf(r);c!==-1&&n.splice(c,1)}}$set(e){this.$$set&&!pe(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const rt="",ke="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48IS0tISBGb250IEF3ZXNvbWUgUHJvIDYuMi4wIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlIChDb21tZXJjaWFsIExpY2Vuc2UpIENvcHlyaWdodCAyMDIyIEZvbnRpY29ucywgSW5jLiAtLT48cGF0aCBkPSJNNTAyLjYgNzAuNjNsLTYxLjI1LTYxLjI1QzQzNS40IDMuMzcxIDQyNy4yIDAgNDE4LjcgMEgyNTUuMWMtMzUuMzUgMC02NCAyOC42Ni02NCA2NGwuMDE5NSAyNTZDMTkyIDM1NS40IDIyMC43IDM4NCAyNTYgMzg0aDE5MmMzNS4yIDAgNjQtMjguOCA2NC02NFY5My4yNUM1MTIgODQuNzcgNTA4LjYgNzYuNjMgNTAyLjYgNzAuNjN6TTQ2NCAzMjBjMCA4LjgzNi03LjE2NCAxNi0xNiAxNkgyNTUuMWMtOC44MzggMC0xNi03LjE2NC0xNi0xNkwyMzkuMSA2NC4xM2MwLTguODM2IDcuMTY0LTE2IDE2LTE2aDEyOEwzODQgOTZjMCAxNy42NyAxNC4zMyAzMiAzMiAzMmg0Ny4xVjMyMHpNMjcyIDQ0OGMwIDguODM2LTcuMTY0IDE2LTE2IDE2SDYzLjFjLTguODM4IDAtMTYtNy4xNjQtMTYtMTZMNDcuOTggMTkyLjFjMC04LjgzNiA3LjE2NC0xNiAxNi0xNkgxNjBWMTI4SDYzLjk5Yy0zNS4zNSAwLTY0IDI4LjY1LTY0IDY0bC4wMDk4IDI1NkMuMDAyIDQ4My4zIDI4LjY2IDUxMiA2NCA1MTJoMTkyYzM1LjIgMCA2NC0yOC44IDY0LTY0di0zMmgtNDcuMUwyNzIgNDQ4eiIvPjwvc3ZnPg==",Le="A 'merge' property is required",Oe="Property 'merge' must be an array",ze="Property 'merge' must contain at least one element",Ye="A 'find' property is required on every element inside 'merge'",Re="Every 'find' property inside 'merge' must be of type string",Ue="Every 'find' property inside 'merge' must be a string of length equal to or higher than one",$e="A 'replace' property is required on every element inside 'merge'",Pe="Unexpected error while parsing template JSON";class w extends Error{constructor(e){super(e)}}function X(t,e){return!(t in e)}function Be(t,e){return!(e[t]instanceof Array)}function Fe(t,e){return typeof e[t]!="string"}function Ze(t,e){return!(typeof e[t]=="string"&&e[t].length>0)}function Je(t,e){return!(e[t]instanceof Array&&e[t].length>0)}function Ge(t){try{const e=JSON.parse(t);if(X("merge",e))throw new w(Le);if(Be("merge",e))throw new w(Oe);if(Je("merge",e))throw new w(ze);const r=He(e.merge);return{...e,merge:r}}catch(e){throw ne(e)}}function He(t){return t.map(r=>{if(X("find",r))throw new w(Ye);if(X("replace",r))throw new w($e);if(Fe("find",r))throw new w(Re);if(Ze("find",r))throw new w(Ue);return r}).map(({find:r,replace:n})=>({find:r,replace:le(n)}))}function Ve(t){return typeof t=="object"&&t!==null&&"message"in t}function ne(t){return t instanceof Error?t:Ve(t)?new w(t.message):new w(Pe)}function le(t){return typeof t=="string"?t:JSON.stringify(t)}class ie{constructor(e){L(this,"template");L(this,"_result");L(this,"_error");L(this,"handlers");this._error=null,this.template={merge:[]},this._result={merge:[]},this.handlers={change:[],submit:[],error:[]},this.setTemplateSource(e)}set error(e){const r=this._error&&{...this._error}||null;this._error=e,e!==null&&this.handlers.error.forEach(n=>n(e,r))}get error(){return this._error}set result(e){const r={...this._result};this._result=e,this.handlers.change.forEach(n=>n(e,r))}get result(){return this._result}on(e,r){this.handlers[e].push(r)}submit(){if(this.error)throw this.error;this.handlers.submit.forEach(e=>e(this.result))}setTemplateSource(e){try{const r=Ge(le(e));this.template=r,this.result=r,this.error=null}catch(r){const n=ne(r);this.error=n}}updateResultMergeFields(e){const{find:r,replace:n}=e,c={find:r,replace:n},o=this.result.merge.map(i=>(i==null?void 0:i.find)===e.find?c:i);return this.result={...this.result,merge:o},o}}const Qe={merge:[{find:"NAME",replace:"world"}],timeline:{tracks:[{clips:[{asset:{type:"title",text:"Hello {{ NAME }}",style:"future"},start:0,length:5}]}]},output:{format:"mp4",resolution:"hd"}},st="";function se(t,e,r){const n=t.slice();return n[9]=e[r].find,n[10]=e[r].replace,n}function ae(t){let e,r,n=t[2].message+"",c;return{c(){e=N("p"),r=N("span"),c=C(n),this.h()},l(o){e=E(o,"P",{"data-cy":!0,class:!0});var i=b(e);r=E(i,"SPAN",{class:!0});var s=b(r);c=k(s,n),s.forEach(g),i.forEach(g),this.h()},h(){h(r,"class","monospace text-orange-900 svelte-u6rap9"),h(e,"data-cy","template-input-error"),h(e,"class","bg-rose-200 rounded py-2 px-4 svelte-u6rap9")},m(o,i){O(o,e,i),_(e,r),_(r,c)},p(o,i){i&4&&n!==(n=o[2].message+"")&&H(c,n)},d(o){o&&g(e)}}}function ce(t){let e,r,n,c,o,i=t[0].merge,s=[];for(let l=0;l<i.length;l+=1)s[l]=oe(se(t,i,l));return{c(){e=N("div"),r=N("h1"),n=C("Modify Merge Values"),c=D(),o=N("div");for(let l=0;l<s.length;l+=1)s[l].c();this.h()},l(l){e=E(l,"DIV",{"data-cy":!0,class:!0});var a=b(e);r=E(a,"H1",{class:!0});var u=b(r);n=k(u,"Modify Merge Values"),u.forEach(g),c=S(a),o=E(a,"DIV",{class:!0});var m=b(o);for(let p=0;p<s.length;p+=1)s[p].l(m);m.forEach(g),a.forEach(g),this.h()},h(){h(r,"class","text-teal-400 px-1 svelte-u6rap9"),h(o,"class","border p-4 mb-6 svelte-u6rap9"),h(e,"data-cy","merge-fields-input-section"),h(e,"class","svelte-u6rap9")},m(l,a){O(l,e,a),_(e,r),_(r,n),_(e,c),_(e,o);for(let u=0;u<s.length;u+=1)s[u].m(o,null)},p(l,a){if(a&17){i=l[0].merge;let u;for(u=0;u<i.length;u+=1){const m=se(l,i,u);s[u]?s[u].p(m,a):(s[u]=oe(m),s[u].c(),s[u].m(o,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=i.length}},d(l){l&&g(e),Ne(s,l)}}}function oe(t){let e,r,n="{{ "+t[9]+" }} ",c,o,i,s,l,a,u,m,p;function M(...d){return t[8](t[9],...d)}return{c(){e=N("div"),r=N("label"),c=C(n),i=D(),s=N("input"),u=D(),this.h()},l(d){e=E(d,"DIV",{"data-cy":!0,class:!0});var f=b(e);r=E(f,"LABEL",{for:!0,class:!0});var y=b(r);c=k(y,n),y.forEach(g),i=S(f),s=E(f,"INPUT",{class:!0,id:!0,type:!0}),u=S(f),f.forEach(g),this.h()},h(){h(r,"for",o=t[9]),h(r,"class","block mb-2 monospace svelte-u6rap9"),h(s,"class","border w-full mb-3 pl-2 py-1 text-stone-500 svelte-u6rap9"),h(s,"id",l=t[9]),h(s,"type","text"),s.value=a=t[10],h(e,"data-cy","label-input"),h(e,"class","svelte-u6rap9")},m(d,f){O(d,e,f),_(e,r),_(r,c),_(e,i),_(e,s),_(e,u),m||(p=G(s,"input",M),m=!0)},p(d,f){t=d,f&1&&n!==(n="{{ "+t[9]+" }} ")&&H(c,n),f&1&&o!==(o=t[9])&&h(r,"for",o),f&1&&l!==(l=t[9])&&h(s,"id",l),f&1&&a!==(a=t[10])&&s.value!==a&&(s.value=a)},d(d){d&&g(e),m=!1,p()}}}function ue(t){let e,r,n,c,o,i,s,l,a,u=Z(t[1])+"",m,p,M;return{c(){e=N("div"),r=N("h1"),n=C("Result"),c=D(),o=N("abbr"),i=N("img"),l=D(),a=N("p"),m=C(u),this.h()},l(d){e=E(d,"DIV",{"data-cy":!0,class:!0});var f=b(e);r=E(f,"H1",{class:!0});var y=b(r);n=k(y,"Result"),y.forEach(g),c=S(f),o=E(f,"ABBR",{title:!0,class:!0});var R=b(o);i=E(R,"IMG",{src:!0,alt:!0,class:!0}),R.forEach(g),l=S(f),a=E(f,"P",{"data-cy":!0,class:!0});var v=b(a);m=k(v,u),v.forEach(g),f.forEach(g),this.h()},h(){h(r,"class","text-teal-400 px-1 inline-block mr-2 svelte-u6rap9"),me(i.src,s=ke)||h(i,"src",s),h(i,"alt","copy-button"),h(i,"class","h-4 cursor-pointer inline mb-1 svelte-u6rap9"),h(o,"title","Copy to clipboard"),h(o,"class","svelte-u6rap9"),h(a,"data-cy","result"),h(a,"class","h-60 overflow-auto border p-4 whitespace-pre monospace svelte-u6rap9"),h(e,"data-cy","result-section"),h(e,"class","svelte-u6rap9")},m(d,f){O(d,e,f),_(e,r),_(r,n),_(e,c),_(e,o),_(o,i),_(e,l),_(e,a),_(a,m),p||(M=G(i,"click",t[5]),p=!0)},p(d,f){f&2&&u!==(u=Z(d[1])+"")&&H(m,u)},d(d){d&&g(e),p=!1,M()}}}function We(t){var R;let e,r,n,c,o,i,s,l,a,u,m,p,M,d=t[2]&&ae(t),f=((R=t[0].merge)==null?void 0:R.length)&&!t[2]&&ce(t),y=!t[2]&&ue(t);return{c(){e=N("section"),r=N("form"),n=N("div"),c=N("label"),o=C("Paste template"),i=D(),s=N("textarea"),a=D(),d&&d.c(),u=D(),f&&f.c(),m=D(),y&&y.c(),this.h()},l(v){e=E(v,"SECTION",{"data-cy":!0,class:!0});var T=b(e);r=E(T,"FORM",{class:!0});var x=b(r);n=E(x,"DIV",{"data-cy":!0,class:!0});var J=b(n);c=E(J,"LABEL",{for:!0,class:!0});var fe=b(c);o=k(fe,"Paste template"),fe.forEach(g),i=S(J),s=E(J,"TEXTAREA",{"data-cy":!0,class:!0,id:!0}),b(s).forEach(g),J.forEach(g),a=S(x),d&&d.l(x),u=S(x),f&&f.l(x),x.forEach(g),m=S(T),y&&y.l(T),T.forEach(g),this.h()},h(){h(c,"for","json-input"),h(c,"class","text-teal-400 px-1 svelte-u6rap9"),h(s,"data-cy","template-input"),h(s,"class","w-full h-60 monospace border p-4 overflow-auto whitespace-pre resize-none svelte-u6rap9"),h(s,"id","json-input"),s.value=l=Z(t[0]),h(n,"data-cy","template-input-section"),h(n,"class","mb-6 svelte-u6rap9"),h(r,"class","svelte-u6rap9"),h(e,"data-cy","form-container"),h(e,"class","max-w-lg my-4 mx-auto border rounded-xl px-7 py-4 svelte-u6rap9")},m(v,T){O(v,e,T),_(e,r),_(r,n),_(n,c),_(c,o),_(n,i),_(n,s),_(r,a),d&&d.m(r,null),_(r,u),f&&f.m(r,null),_(e,m),y&&y.m(e,null),p||(M=G(s,"input",t[7]),p=!0)},p(v,[T]){var x;T&1&&l!==(l=Z(v[0]))&&(s.value=l),v[2]?d?d.p(v,T):(d=ae(v),d.c(),d.m(r,u)):d&&(d.d(1),d=null),((x=v[0].merge)==null?void 0:x.length)&&!v[2]?f?f.p(v,T):(f=ce(v),f.c(),f.m(r,null)):f&&(f.d(1),f=null),v[2]?y&&(y.d(1),y=null):y?y.p(v,T):(y=ue(v),y.c(),y.m(e,null))},i:I,o:I,d(v){v&&g(e),d&&d.d(),f&&f.d(),y&&y.d(),p=!1,M()}}}function Z(t){return JSON.stringify(t,null,2)}function qe(t,e,r){let{editTemplateService:n=new ie(Qe)}=e,c=n.template,o=n.result,i=null;function s(p){n.setTemplateSource(p),r(0,c=n.template),r(1,o=n.result),r(2,i=n.error)}function l(p){n.updateResultMergeFields(p),r(1,o=n.result)}function a(){navigator.clipboard.writeText(JSON.stringify(o)),alert("JSON copied to clipboard!")}const u=p=>s(p.currentTarget.value),m=(p,M)=>l({find:p,replace:M.currentTarget.value});return t.$$set=p=>{"editTemplateService"in p&&r(6,n=p.editTemplateService)},[c,o,i,s,l,a,n,u,m]}class Xe extends Ce{constructor(e){super(),je(this,e,qe,We,he,{editTemplateService:6})}}class Ke{constructor(e,r=document.querySelector("#shotstack-form-field")){L(this,"templateService");this.containerElement=r,this.templateService=new ie(e),this.initialize()}on(e,r){this.templateService.on(e,r)}submit(){this.templateService.submit()}initialize(){!this.containerElement||this.containerElement&&this.render(this.containerElement)}render(e){new Xe({target:e,props:{editTemplateService:this.templateService}})}display(){!this.containerElement||(this.containerElement.style.display="block")}hide(){!this.containerElement||(this.containerElement.style.display="none")}attach(e){this.remove(),this.containerElement=e,this.render(this.containerElement)}remove(){!this.containerElement||this.containerElement.replaceChildren()}get container(){if(!!this.containerElement)return this.containerElement}merge(){return this.templateService.result}}return Ke}();
