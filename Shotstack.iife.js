var Shotstack=function(){"use strict";var We=Object.defineProperty;var $e=(T,I,j)=>I in T?We(T,I,{enumerable:!0,configurable:!0,writable:!0,value:j}):T[I]=j;var R=(T,I,j)=>($e(T,typeof I!="symbol"?I+"":I,j),j);function T(){}function I(t){return t()}function j(){return Object.create(null)}function F(t){t.forEach(I)}function ue(t){return typeof t=="function"}function fe(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}let J;function de(t,e){return J||(J=document.createElement("a")),J.href=e,t===J.href}function he(t){return Object.keys(t).length===0}let B=!1;function pe(){B=!0}function me(){B=!1}function _e(t,e,n,r){for(;t<e;){const a=t+(e-t>>1);n(a)<=r?t=a+1:e=a}return t}function ge(t){if(t.hydrate_init)return;t.hydrate_init=!0;let e=t.childNodes;if(t.nodeName==="HEAD"){const l=[];for(let c=0;c<e.length;c++){const u=e[c];u.claim_order!==void 0&&l.push(u)}e=l}const n=new Int32Array(e.length+1),r=new Int32Array(e.length);n[0]=-1;let a=0;for(let l=0;l<e.length;l++){const c=e[l].claim_order,u=(a>0&&e[n[a]].claim_order<=c?a+1:_e(1,a,m=>e[n[m]].claim_order,c))-1;r[l]=n[u]+1;const d=u+1;n[d]=l,a=Math.max(d,a)}const o=[],i=[];let s=e.length-1;for(let l=n[a]+1;l!=0;l=r[l-1]){for(o.push(e[l-1]);s>=l;s--)i.push(e[s]);s--}for(;s>=0;s--)i.push(e[s]);o.reverse(),i.sort((l,c)=>l.claim_order-c.claim_order);for(let l=0,c=0;l<i.length;l++){for(;c<o.length&&i[l].claim_order>=o[c].claim_order;)c++;const u=c<o.length?o[c]:null;t.insertBefore(i[l],u)}}function _(t,e){if(B){for(ge(t),(t.actual_end_child===void 0||t.actual_end_child!==null&&t.actual_end_child.parentNode!==t)&&(t.actual_end_child=t.firstChild);t.actual_end_child!==null&&t.actual_end_child.claim_order===void 0;)t.actual_end_child=t.actual_end_child.nextSibling;e!==t.actual_end_child?(e.claim_order!==void 0||e.parentNode!==t)&&t.insertBefore(e,t.actual_end_child):t.actual_end_child=e.nextSibling}else(e.parentNode!==t||e.nextSibling!==null)&&t.appendChild(e)}function C(t,e,n){B&&!n?_(t,e):(e.parentNode!==t||e.nextSibling!=n)&&t.insertBefore(e,n||null)}function g(t){t.parentNode.removeChild(t)}function ye(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function v(t){return document.createElement(t)}function x(t){return document.createTextNode(t)}function S(){return x(" ")}function G(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function p(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function M(t){return Array.from(t.childNodes)}function Ne(t){t.claim_info===void 0&&(t.claim_info={last_index:0,total_claimed:0})}function X(t,e,n,r,a=!1){Ne(t);const o=(()=>{for(let i=t.claim_info.last_index;i<t.length;i++){const s=t[i];if(e(s)){const l=n(s);return l===void 0?t.splice(i,1):t[i]=l,a||(t.claim_info.last_index=i),s}}for(let i=t.claim_info.last_index-1;i>=0;i--){const s=t[i];if(e(s)){const l=n(s);return l===void 0?t.splice(i,1):t[i]=l,a?l===void 0&&t.claim_info.last_index--:t.claim_info.last_index=i,s}}return r()})();return o.claim_order=t.claim_info.total_claimed,t.claim_info.total_claimed+=1,o}function ve(t,e,n,r){return X(t,a=>a.nodeName===e,a=>{const o=[];for(let i=0;i<a.attributes.length;i++){const s=a.attributes[i];n[s.name]||o.push(s.name)}o.forEach(i=>a.removeAttribute(i))},()=>r(e))}function b(t,e,n){return ve(t,e,n,v)}function k(t,e){return X(t,n=>n.nodeType===3,n=>{const r=""+e;if(n.data.startsWith(r)){if(n.data.length!==r.length)return n.splitText(r.length)}else n.data=r},()=>x(e),!0)}function w(t){return k(t," ")}function H(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}let V;function O(t){V=t}const z=[],K=[],P=[],ee=[],be=Promise.resolve();let Q=!1;function Me(){Q||(Q=!0,be.then(te))}function W(t){P.push(t)}const $=new Set;let U=0;function te(){const t=V;do{for(;U<z.length;){const e=z[U];U++,O(e),Ee(e.$$)}for(O(null),z.length=0,U=0;K.length;)K.pop()();for(let e=0;e<P.length;e+=1){const n=P[e];$.has(n)||($.add(n),n())}P.length=0}while(z.length);for(;ee.length;)ee.pop()();Q=!1,$.clear(),O(t)}function Ee(t){if(t.fragment!==null){t.update(),F(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(W)}}const Te=new Set;function Ie(t,e){t&&t.i&&(Te.delete(t),t.i(e))}function Ae(t,e,n,r){const{fragment:a,on_mount:o,on_destroy:i,after_update:s}=t.$$;a&&a.m(e,n),r||W(()=>{const l=o.map(I).filter(ue);i?i.push(...l):F(l),t.$$.on_mount=[]}),s.forEach(W)}function Se(t,e){const n=t.$$;n.fragment!==null&&(F(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function we(t,e){t.$$.dirty[0]===-1&&(z.push(t),Me(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function De(t,e,n,r,a,o,i,s=[-1]){const l=V;O(t);const c=t.$$={fragment:null,ctx:null,props:o,update:T,not_equal:a,bound:j(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(l?l.$$.context:[])),callbacks:j(),dirty:s,skip_bound:!1,root:e.target||l.$$.root};i&&i(c.root);let u=!1;if(c.ctx=n?n(t,e.props||{},(d,m,...A)=>{const h=A.length?A[0]:m;return c.ctx&&a(c.ctx[d],c.ctx[d]=h)&&(!c.skip_bound&&c.bound[d]&&c.bound[d](h),u&&we(t,d)),m}):[],c.update(),u=!0,F(c.before_update),c.fragment=r?r(c.ctx):!1,e.target){if(e.hydrate){pe();const d=M(e.target);c.fragment&&c.fragment.l(d),d.forEach(g)}else c.fragment&&c.fragment.c();e.intro&&Ie(t.$$.fragment),Ae(t,e.target,e.anchor,e.customElement),me(),te()}O(l)}class je{$destroy(){Se(this,1),this.$destroy=T}$on(e,n){const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const a=r.indexOf(n);a!==-1&&r.splice(a,1)}}$set(e){this.$$set&&!he(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const qe="",xe="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48IS0tISBGb250IEF3ZXNvbWUgUHJvIDYuMi4wIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlIChDb21tZXJjaWFsIExpY2Vuc2UpIENvcHlyaWdodCAyMDIyIEZvbnRpY29ucywgSW5jLiAtLT48cGF0aCBkPSJNNTAyLjYgNzAuNjNsLTYxLjI1LTYxLjI1QzQzNS40IDMuMzcxIDQyNy4yIDAgNDE4LjcgMEgyNTUuMWMtMzUuMzUgMC02NCAyOC42Ni02NCA2NGwuMDE5NSAyNTZDMTkyIDM1NS40IDIyMC43IDM4NCAyNTYgMzg0aDE5MmMzNS4yIDAgNjQtMjguOCA2NC02NFY5My4yNUM1MTIgODQuNzcgNTA4LjYgNzYuNjMgNTAyLjYgNzAuNjN6TTQ2NCAzMjBjMCA4LjgzNi03LjE2NCAxNi0xNiAxNkgyNTUuMWMtOC44MzggMC0xNi03LjE2NC0xNi0xNkwyMzkuMSA2NC4xM2MwLTguODM2IDcuMTY0LTE2IDE2LTE2aDEyOEwzODQgOTZjMCAxNy42NyAxNC4zMyAzMiAzMiAzMmg0Ny4xVjMyMHpNMjcyIDQ0OGMwIDguODM2LTcuMTY0IDE2LTE2IDE2SDYzLjFjLTguODM4IDAtMTYtNy4xNjQtMTYtMTZMNDcuOTggMTkyLjFjMC04LjgzNiA3LjE2NC0xNiAxNi0xNkgxNjBWMTI4SDYzLjk5Yy0zNS4zNSAwLTY0IDI4LjY1LTY0IDY0bC4wMDk4IDI1NkMuMDAyIDQ4My4zIDI4LjY2IDUxMiA2NCA1MTJoMTkyYzM1LjIgMCA2NC0yOC44IDY0LTY0di0zMmgtNDcuMUwyNzIgNDQ4eiIvPjwvc3ZnPg==",Le="A 'merge' property is required",ke="Property 'merge' must be an array",Ce="Property 'merge' must contain at least one element",Oe="A 'find' property is required on every element inside 'merge'",ze="Every 'find' property inside 'merge' must be of type string",Ye="Every 'find' property inside 'merge' must be a string of length equal to or higher than one",Re="A 'replace' property is required on every element inside 'merge'";class L extends Error{constructor(e){super(e)}}function q(t,e){return!(t in e)}function Fe(t,e){return!(e[t]instanceof Array)}function Je(t,e){return typeof e[t]!="string"}function Be(t,e){return!(typeof e[t]=="string"&&e[t].length>0)}function Pe(t,e){return!(e[t]instanceof Array&&e[t].length>0)}function ne(t){try{const e=JSON.parse(t);if(q("merge",e))throw new L(Le);if(Fe("merge",e))throw new L(ke);if(Pe("merge",e))throw new L(Ce);const n=Ue(e.merge);return{...e,merge:n}}catch(e){throw e instanceof Error?e:new L("There was a problem parsing the template json")}}function Ue(t){return t.map(n=>{if(q("find",n))throw new L(Oe);if(q("replace",n))throw new L(Re);if(Je("find",n))throw new L(ze);if(Be("find",n))throw new L(Ye);return n}).map(({find:n,replace:r})=>({find:n,replace:typeof r=="string"?r:JSON.stringify(r)}))}class re{constructor(e){R(this,"template");R(this,"_result");R(this,"handlers");const n=this.parseInitialTemplate(e);this.template=n,this._result=n,this.handlers={change:[],submit:[]}}set result(e){this._result=e,this.handlers.change.forEach(n=>n(e))}get result(){return this._result}on(e,n){this.handlers[e].push(n)}submit(){this.handlers.submit.forEach(e=>e(this.result))}parseInitialTemplate(e){const r=typeof e=="string"?e:JSON.stringify(e);try{return ne(r)}catch{return{merge:[]}}}setTemplateSource(e){try{const n=ne(e);return this.template=n,this.result=n,n}catch(n){throw n instanceof Error?n:new Error("Error parsing JSON")}}updateResultMergeFields(e){const{find:n,replace:r}=e,a={find:n,replace:r},o=this.result.merge.map(i=>(i==null?void 0:i.find)===e.find?a:i);return this.result={...this.result,merge:o},o}}const Ze={merge:[{find:"NAME",replace:"world"}],timeline:{tracks:[{clips:[{asset:{type:"title",text:"Hello {{ NAME }}",style:"future"},start:0,length:5}]}]},output:{format:"mp4",resolution:"hd"}},tt="";function le(t,e,n){const r=t.slice();return r[8]=e[n].find,r[9]=e[n].replace,r}function ie(t){let e,n,r;return{c(){e=v("p"),n=v("span"),r=x(t[2]),this.h()},l(a){e=b(a,"P",{"data-cy":!0,class:!0});var o=M(e);n=b(o,"SPAN",{class:!0});var i=M(n);r=k(i,t[2]),i.forEach(g),o.forEach(g),this.h()},h(){p(n,"class","monospace text-orange-900 svelte-u6rap9"),p(e,"data-cy","template-input-error"),p(e,"class","bg-rose-200 rounded py-2 px-4 svelte-u6rap9")},m(a,o){C(a,e,o),_(e,n),_(n,r)},p(a,o){o&4&&H(r,a[2])},d(a){a&&g(e)}}}function se(t){let e,n,r,a,o,i=t[0].merge,s=[];for(let l=0;l<i.length;l+=1)s[l]=ae(le(t,i,l));return{c(){e=v("div"),n=v("h1"),r=x("Modify Merge Values"),a=S(),o=v("div");for(let l=0;l<s.length;l+=1)s[l].c();this.h()},l(l){e=b(l,"DIV",{"data-cy":!0,class:!0});var c=M(e);n=b(c,"H1",{class:!0});var u=M(n);r=k(u,"Modify Merge Values"),u.forEach(g),a=w(c),o=b(c,"DIV",{class:!0});var d=M(o);for(let m=0;m<s.length;m+=1)s[m].l(d);d.forEach(g),c.forEach(g),this.h()},h(){p(n,"class","text-teal-400 px-1 svelte-u6rap9"),p(o,"class","border p-4 mb-6 svelte-u6rap9"),p(e,"data-cy","merge-fields-input-section"),p(e,"class","svelte-u6rap9")},m(l,c){C(l,e,c),_(e,n),_(n,r),_(e,a),_(e,o);for(let u=0;u<s.length;u+=1)s[u].m(o,null)},p(l,c){if(c&17){i=l[0].merge;let u;for(u=0;u<i.length;u+=1){const d=le(l,i,u);s[u]?s[u].p(d,c):(s[u]=ae(d),s[u].c(),s[u].m(o,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=i.length}},d(l){l&&g(e),ye(s,l)}}}function ae(t){let e,n,r="{{ "+t[8]+" }} ",a,o,i,s,l,c,u,d,m;function A(...h){return t[7](t[8],...h)}return{c(){e=v("div"),n=v("label"),a=x(r),i=S(),s=v("input"),u=S(),this.h()},l(h){e=b(h,"DIV",{"data-cy":!0,class:!0});var f=M(e);n=b(f,"LABEL",{for:!0,class:!0});var y=M(n);a=k(y,r),y.forEach(g),i=w(f),s=b(f,"INPUT",{class:!0,id:!0,type:!0}),u=w(f),f.forEach(g),this.h()},h(){p(n,"for",o=t[8]),p(n,"class","block mb-2 monospace svelte-u6rap9"),p(s,"class","border w-full mb-3 pl-2 py-1 text-stone-500 svelte-u6rap9"),p(s,"id",l=t[8]),p(s,"type","text"),s.value=c=t[9],p(e,"data-cy","label-input"),p(e,"class","svelte-u6rap9")},m(h,f){C(h,e,f),_(e,n),_(n,a),_(e,i),_(e,s),_(e,u),d||(m=G(s,"input",A),d=!0)},p(h,f){t=h,f&1&&r!==(r="{{ "+t[8]+" }} ")&&H(a,r),f&1&&o!==(o=t[8])&&p(n,"for",o),f&1&&l!==(l=t[8])&&p(s,"id",l),f&1&&c!==(c=t[9])&&s.value!==c&&(s.value=c)},d(h){h&&g(e),d=!1,m()}}}function ce(t){let e,n,r,a,o,i,s,l,c,u=JSON.stringify(t[1],null,2)+"",d,m,A;return{c(){e=v("div"),n=v("h1"),r=x("Result"),a=S(),o=v("abbr"),i=v("img"),l=S(),c=v("p"),d=x(u),this.h()},l(h){e=b(h,"DIV",{"data-cy":!0,class:!0});var f=M(e);n=b(f,"H1",{class:!0});var y=M(n);r=k(y,"Result"),y.forEach(g),a=w(f),o=b(f,"ABBR",{title:!0,class:!0});var Y=M(o);i=b(Y,"IMG",{src:!0,alt:!0,class:!0}),Y.forEach(g),l=w(f),c=b(f,"P",{"data-cy":!0,class:!0});var N=M(c);d=k(N,u),N.forEach(g),f.forEach(g),this.h()},h(){p(n,"class","text-teal-400 px-1 inline-block mr-2 svelte-u6rap9"),de(i.src,s=xe)||p(i,"src",s),p(i,"alt","copy-button"),p(i,"class","h-4 cursor-pointer inline mb-1 svelte-u6rap9"),p(o,"title","Copy to clipboard"),p(o,"class","svelte-u6rap9"),p(c,"data-cy","result"),p(c,"class","h-60 overflow-auto border p-4 whitespace-pre monospace svelte-u6rap9"),p(e,"data-cy","result-section"),p(e,"class","svelte-u6rap9")},m(h,f){C(h,e,f),_(e,n),_(n,r),_(e,a),_(e,o),_(o,i),_(e,l),_(e,c),_(c,d),m||(A=G(i,"click",t[5]),m=!0)},p(h,f){f&2&&u!==(u=JSON.stringify(h[1],null,2)+"")&&H(d,u)},d(h){h&&g(e),m=!1,A()}}}function Ge(t){var Y;let e,n,r,a,o,i,s,l,c,u,d,m,A,h=t[2]&&ie(t),f=((Y=t[0].merge)==null?void 0:Y.length)&&!t[2]&&se(t),y=!t[2]&&ce(t);return{c(){e=v("section"),n=v("form"),r=v("div"),a=v("label"),o=x("Paste template"),i=S(),s=v("textarea"),c=S(),h&&h.c(),u=S(),f&&f.c(),d=S(),y&&y.c(),this.h()},l(N){e=b(N,"SECTION",{"data-cy":!0,class:!0});var E=M(e);n=b(E,"FORM",{class:!0});var D=M(n);r=b(D,"DIV",{"data-cy":!0,class:!0});var Z=M(r);a=b(Z,"LABEL",{for:!0,class:!0});var oe=M(a);o=k(oe,"Paste template"),oe.forEach(g),i=w(Z),s=b(Z,"TEXTAREA",{"data-cy":!0,class:!0,id:!0}),M(s).forEach(g),Z.forEach(g),c=w(D),h&&h.l(D),u=w(D),f&&f.l(D),D.forEach(g),d=w(E),y&&y.l(E),E.forEach(g),this.h()},h(){p(a,"for","json-input"),p(a,"class","text-teal-400 px-1 svelte-u6rap9"),p(s,"data-cy","template-input"),p(s,"class","w-full h-60 monospace border p-4 overflow-auto whitespace-pre resize-none svelte-u6rap9"),p(s,"id","json-input"),s.value=l=JSON.stringify(t[0],null,2),p(r,"data-cy","template-input-section"),p(r,"class","mb-6 svelte-u6rap9"),p(n,"class","svelte-u6rap9"),p(e,"data-cy","form-container"),p(e,"class","max-w-lg my-4 mx-auto border rounded-xl px-7 py-4 svelte-u6rap9")},m(N,E){C(N,e,E),_(e,n),_(n,r),_(r,a),_(a,o),_(r,i),_(r,s),_(n,c),h&&h.m(n,null),_(n,u),f&&f.m(n,null),_(e,d),y&&y.m(e,null),m||(A=G(s,"input",t[3]),m=!0)},p(N,[E]){var D;E&1&&l!==(l=JSON.stringify(N[0],null,2))&&(s.value=l),N[2]?h?h.p(N,E):(h=ie(N),h.c(),h.m(n,u)):h&&(h.d(1),h=null),((D=N[0].merge)==null?void 0:D.length)&&!N[2]?f?f.p(N,E):(f=se(N),f.c(),f.m(n,null)):f&&(f.d(1),f=null),N[2]?y&&(y.d(1),y=null):y?y.p(N,E):(y=ce(N),y.c(),y.m(e,null))},i:T,o:T,d(N){N&&g(e),h&&h.d(),f&&f.d(),y&&y.d(),m=!1,A()}}}function He(t,e,n){let{editTemplateService:r=new re(Ze)}=e,a=r.template,o=r.result,i=null;function s(d){try{const m=r.setTemplateSource(d.target.value);n(0,a=m),n(1,o=m),n(2,i=null)}catch(m){n(2,i=m.message)}}function l(d){try{const m=r.updateResultMergeFields(d);n(1,o={...o,merge:m}),n(2,i=null)}catch(m){n(2,i=m.message)}}function c(){navigator.clipboard.writeText(JSON.stringify(o)),alert("JSON copied to clipboard!")}const u=(d,m)=>l({find:d,replace:m.currentTarget.value});return t.$$set=d=>{"editTemplateService"in d&&n(6,r=d.editTemplateService)},[a,o,i,s,l,c,r,u]}class Ve extends je{constructor(e){super(),De(this,e,He,Ge,fe,{editTemplateService:6})}}class Qe{constructor(e,n=document.querySelector("#shotstack-form-field")){R(this,"templateService");this.container=n,this.templateService=new re(e),this.initialize()}on(e,n){this.templateService.on(e,n)}submit(){this.templateService.submit()}initialize(){this.container&&this.render(this.container)}render(e){new Ve({target:e,props:{editTemplateService:this.templateService}})}}return Qe}();
