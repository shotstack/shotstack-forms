var ee=Object.defineProperty;var te=(r,e,t)=>e in r?ee(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var F=(r,e,t)=>(te(r,typeof e!="symbol"?e+"":e,t),t);import{S as z,i as K,s as Q,k as E,q as k,a as R,l as b,m as N,r as D,h as _,c as M,n as u,b as J,F as p,H as L,A as U,u as B,I as re,J as se,v as le,w as ae,x as ne,f as oe,t as ie,y as ue}from"../../chunks/index-16192b9f.js";const ce=""+new URL("../../assets/copy-regular-423f8619.svg",import.meta.url).href,fe="A 'merge' property is required",de="Property 'merge' must be an array",pe="Property 'merge' must contain at least one element",he="A 'find' property is required on every element inside 'merge'",me="Every 'find' property inside 'merge' must be of type string",_e="Every 'find' property inside 'merge' must be a string of length equal to or higher than one",ve="A 'replace' property is required on every element inside 'merge'",ge="Unexpected error while parsing template JSON",ye="Every element inside the 'merge' should be an object";class O extends Error{constructor(e){super(e)}}function Ee(r){return typeof r=="object"}function C(r,e){return r in e}function G(r,e){return!C(r,e)}function be(r,e){return C(r,e)&&!(e[r]instanceof Array)}function we(r,e){return C(r,e)&&typeof e[r]!="string"}function Ne(r,e){const t=C(r,e)&&e[r];return!(typeof t=="string"&&t.length>0)}function Te(r,e){const t=C(r,e)&&e[r];return!(t instanceof Array&&t.length>0)}function Oe(r){try{const e=JSON.parse(r);if(G("merge",e))throw new O(fe);if(be("merge",e))throw new O(de);if(Te("merge",e))throw new O(pe);const{merge:t}=e,s=Se(t);return{...e,merge:s}}catch(e){throw W(e)}}function Se(r){return r.map(t=>{if(!Ee(t))throw new O(ye);if(G("find",t))throw new O(he);if(G("replace",t))throw new O(ve);if(we("find",t))throw new O(me);if(Ne("find",t))throw new O(_e);return t}).map(({find:t,replace:s})=>({find:t,replace:Z(s)}))}function Re(r){return typeof r=="object"&&r!==null&&"message"in r}function W(r){return r instanceof Error?r:Re(r)?new O(r.message):new O(ge)}function Z(r){return typeof r=="string"?r:JSON.stringify(r)}class Me{constructor(e){F(this,"template");F(this,"_result");F(this,"_error");F(this,"handlers");this._error=null,this.template={merge:[]},this._result={merge:[]},this.handlers={change:[],submit:[],error:[this.logger]},this.setTemplateSource(e)}set error(e){const t=this._error&&{...this._error}||null;this._error=e,e!==null&&this.handlers.error.forEach(s=>s(e,t))}get error(){return this._error}set result(e){const t={...this._result};this._result=e,this.handlers.change.forEach(s=>s(e,t))}get result(){return this._result}on(e,t){this.handlers[e].push(t)}off(e,t){this.handlers[e].filter(s=>s!==t)}submit(){if(this.error)throw this.error;this.handlers.submit.forEach(e=>e(this.result))}setTemplateSource(e){try{const t=Oe(Z(e));this.template=t,this.result=t,this.error=null}catch(t){const s=W(t);this.error=s}}updateResultMergeFields(e){const{find:t,replace:s}=e,f={find:t,replace:s},l=this.result.merge.map(i=>(i==null?void 0:i.find)===e.find?f:i);return this.result={...this.result,merge:l},l}logger(e){console.error(e)}}const Ae=[{find:"NAME",replace:"world"}],Ie={tracks:[{clips:[{asset:{type:"title",text:"Hello {{ NAME }}",style:"future"},start:0,length:5}]}]},ke={format:"mp4",resolution:"hd"},De={merge:Ae,timeline:Ie,output:ke};function X(r,e,t){const s=r.slice();return s[9]=e[t].find,s[10]=e[t].replace,s}function Y(r){let e,t,s=r[2].message+"",f;return{c(){e=E("p"),t=E("span"),f=k(s),this.h()},l(l){e=b(l,"P",{"data-cy":!0,class:!0});var i=N(e);t=b(i,"SPAN",{class:!0});var a=N(t);f=D(a,s),a.forEach(_),i.forEach(_),this.h()},h(){u(t,"class","monospace text-orange-900 svelte-r93edu"),u(e,"data-cy","template-input-error"),u(e,"class","bg-rose-200 rounded py-2 px-4 svelte-r93edu")},m(l,i){J(l,e,i),p(e,t),p(t,f)},p(l,i){i&4&&s!==(s=l[2].message+"")&&B(f,s)},d(l){l&&_(e)}}}function j(r){let e,t,s,f,l,i=r[0].merge,a=[];for(let n=0;n<i.length;n+=1)a[n]=$(X(r,i,n));return{c(){e=E("div"),t=E("h1"),s=k("Modify Merge Values"),f=R(),l=E("div");for(let n=0;n<a.length;n+=1)a[n].c();this.h()},l(n){e=b(n,"DIV",{"data-cy":!0,class:!0});var d=N(e);t=b(d,"H1",{class:!0});var c=N(t);s=D(c,"Modify Merge Values"),c.forEach(_),f=M(d),l=b(d,"DIV",{class:!0});var v=N(l);for(let h=0;h<a.length;h+=1)a[h].l(v);v.forEach(_),d.forEach(_),this.h()},h(){u(t,"class","text-teal-400 px-1 svelte-r93edu"),u(l,"class","border p-4 mb-6 svelte-r93edu"),u(e,"data-cy","merge-fields-input-section"),u(e,"class","svelte-r93edu")},m(n,d){J(n,e,d),p(e,t),p(t,s),p(e,f),p(e,l);for(let c=0;c<a.length;c+=1)a[c].m(l,null)},p(n,d){if(d&17){i=n[0].merge;let c;for(c=0;c<i.length;c+=1){const v=X(n,i,c);a[c]?a[c].p(v,d):(a[c]=$(v),a[c].c(),a[c].m(l,null))}for(;c<a.length;c+=1)a[c].d(1);a.length=i.length}},d(n){n&&_(e),re(a,n)}}}function $(r){let e,t,s="{{ "+r[9]+" }} ",f,l,i,a,n,d,c,v,h;function T(...g){return r[8](r[9],...g)}return{c(){e=E("div"),t=E("label"),f=k(s),i=R(),a=E("input"),c=R(),this.h()},l(g){e=b(g,"DIV",{"data-cy":!0,class:!0});var o=N(e);t=b(o,"LABEL",{for:!0,class:!0});var m=N(t);f=D(m,s),m.forEach(_),i=M(o),a=b(o,"INPUT",{class:!0,id:!0,type:!0}),c=M(o),o.forEach(_),this.h()},h(){u(t,"for",l=r[9]),u(t,"class","block mb-2 monospace svelte-r93edu"),u(a,"class","border w-full mb-3 pl-2 py-1 text-stone-500 svelte-r93edu"),u(a,"id",n=r[9]),u(a,"type","text"),a.value=d=r[10],u(e,"data-cy","label-input"),u(e,"class","svelte-r93edu")},m(g,o){J(g,e,o),p(e,t),p(t,f),p(e,i),p(e,a),p(e,c),v||(h=L(a,"input",T),v=!0)},p(g,o){r=g,o&1&&s!==(s="{{ "+r[9]+" }} ")&&B(f,s),o&1&&l!==(l=r[9])&&u(t,"for",l),o&1&&n!==(n=r[9])&&u(a,"id",n),o&1&&d!==(d=r[10])&&a.value!==d&&(a.value=d)},d(g){g&&_(e),v=!1,h()}}}function x(r){let e,t,s,f,l,i,a,n,d,c=q(r[1])+"",v,h,T;return{c(){e=E("div"),t=E("h1"),s=k("Result"),f=R(),l=E("abbr"),i=E("img"),n=R(),d=E("p"),v=k(c),this.h()},l(g){e=b(g,"DIV",{"data-cy":!0,class:!0});var o=N(e);t=b(o,"H1",{class:!0});var m=N(t);s=D(m,"Result"),m.forEach(_),f=M(o),l=b(o,"ABBR",{title:!0,class:!0});var y=N(l);i=b(y,"IMG",{src:!0,alt:!0,class:!0}),y.forEach(_),n=M(o),d=b(o,"P",{"data-cy":!0,class:!0});var P=N(d);v=D(P,c),P.forEach(_),o.forEach(_),this.h()},h(){u(t,"class","text-teal-400 px-1 inline-block mr-2 svelte-r93edu"),se(i.src,a=ce)||u(i,"src",a),u(i,"alt","copy-button"),u(i,"class","h-4 cursor-pointer inline mb-1 svelte-r93edu"),u(l,"title","Copy to clipboard"),u(l,"class","svelte-r93edu"),u(d,"data-cy","result"),u(d,"class","h-60 overflow-auto border p-4 whitespace-pre monospace svelte-r93edu"),u(e,"data-cy","result-section"),u(e,"class","svelte-r93edu")},m(g,o){J(g,e,o),p(e,t),p(t,s),p(e,f),p(e,l),p(l,i),p(e,n),p(e,d),p(d,v),h||(T=L(i,"click",r[5]),h=!0)},p(g,o){o&2&&c!==(c=q(g[1])+"")&&B(v,c)},d(g){g&&_(e),h=!1,T()}}}function Pe(r){var P;let e,t,s,f,l,i,a,n,d,c,v,h,T,g,o=r[2]&&Y(r),m=((P=r[0].merge)==null?void 0:P.length)&&!r[2]&&j(r),y=!r[2]&&x(r);return{c(){e=E("div"),t=E("section"),s=E("form"),f=E("div"),l=E("label"),i=k("Paste template"),a=R(),n=E("textarea"),c=R(),o&&o.c(),v=R(),m&&m.c(),h=R(),y&&y.c(),this.h()},l(w){e=b(w,"DIV",{class:!0});var S=N(e);t=b(S,"SECTION",{"data-cy":!0,class:!0});var A=N(t);s=b(A,"FORM",{class:!0});var I=N(s);f=b(I,"DIV",{"data-cy":!0,class:!0});var V=N(f);l=b(V,"LABEL",{for:!0,class:!0});var H=N(l);i=D(H,"Paste template"),H.forEach(_),a=M(V),n=b(V,"TEXTAREA",{"data-cy":!0,class:!0,id:!0}),N(n).forEach(_),V.forEach(_),c=M(I),o&&o.l(I),v=M(I),m&&m.l(I),I.forEach(_),h=M(A),y&&y.l(A),A.forEach(_),S.forEach(_),this.h()},h(){u(l,"for","json-input"),u(l,"class","text-teal-400 px-1 svelte-r93edu"),u(n,"data-cy","template-input"),u(n,"class","w-full h-60 monospace border p-4 overflow-auto whitespace-pre resize-none svelte-r93edu"),u(n,"id","json-input"),n.value=d=q(r[0]),u(f,"data-cy","template-input-section"),u(f,"class","mb-6 svelte-r93edu"),u(s,"class","svelte-r93edu"),u(t,"data-cy","form-container"),u(t,"class","max-w-lg my-4 mx-auto border rounded-xl px-7 py-4 svelte-r93edu"),u(e,"class","shotstack-mergefield-form svelte-r93edu")},m(w,S){J(w,e,S),p(e,t),p(t,s),p(s,f),p(f,l),p(l,i),p(f,a),p(f,n),p(s,c),o&&o.m(s,null),p(s,v),m&&m.m(s,null),p(t,h),y&&y.m(t,null),T||(g=L(n,"input",r[7]),T=!0)},p(w,[S]){var A;S&1&&d!==(d=q(w[0]))&&(n.value=d),w[2]?o?o.p(w,S):(o=Y(w),o.c(),o.m(s,v)):o&&(o.d(1),o=null),((A=w[0].merge)==null?void 0:A.length)&&!w[2]?m?m.p(w,S):(m=j(w),m.c(),m.m(s,null)):m&&(m.d(1),m=null),w[2]?y&&(y.d(1),y=null):y?y.p(w,S):(y=x(w),y.c(),y.m(t,null))},i:U,o:U,d(w){w&&_(e),o&&o.d(),m&&m.d(),y&&y.d(),T=!1,g()}}}function q(r){return JSON.stringify(r,null,2)}function Fe(r,e,t){let{editTemplateService:s=new Me(De)}=e,f=s.template,l=s.result,i=null;function a(h){s.setTemplateSource(h),t(0,f=s.template),t(1,l=s.result),t(2,i=s.error)}function n(h){s.updateResultMergeFields(h),t(1,l=s.result)}function d(){navigator.clipboard.writeText(JSON.stringify(l)),alert("JSON copied to clipboard!")}const c=h=>a(h.currentTarget.value),v=(h,T)=>n({find:h,replace:T.currentTarget.value});return r.$$set=h=>{"editTemplateService"in h&&t(6,s=h.editTemplateService)},[f,l,i,a,n,d,s,c,v]}class Je extends z{constructor(e){super(),K(this,e,Fe,Pe,Q,{editTemplateService:6})}}function Ce(r){let e,t;return e=new Je({}),{c(){le(e.$$.fragment)},l(s){ae(e.$$.fragment,s)},m(s,f){ne(e,s,f),t=!0},p:U,i(s){t||(oe(e.$$.fragment,s),t=!0)},o(s){ie(e.$$.fragment,s),t=!1},d(s){ue(e,s)}}}class Ue extends z{constructor(e){super(),K(this,e,null,Ce,Q,{})}}export{Ue as default};
