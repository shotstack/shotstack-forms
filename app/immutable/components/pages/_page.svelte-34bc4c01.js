var Q=Object.defineProperty;var W=(r,e,t)=>e in r?Q(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var P=(r,e,t)=>(W(r,typeof e!="symbol"?e+"":e,t),t);import{S as z,i as X,s as K,k as b,q as M,a as S,l as E,m as w,r as R,h as v,c as O,n as c,b as D,F as h,H as q,A as F,u as C,I as Z,J as x,v as $,w as ee,x as te,f as re,t as se,y as le}from"../../chunks/index-16192b9f.js";const ae=""+new URL("../../assets/copy-regular-1afa113a.svg",import.meta.url).href,ne="A 'merge' property is required",ie="Property 'merge' must be an array",oe="Property 'merge' must contain at least one element",ue="A 'find' property is required on every element inside 'merge'",ce="Every 'find' property inside 'merge' must be of type string",pe="Every 'find' property inside 'merge' must be a string of length equal to or higher than one",fe="A 'replace' property is required on every element inside 'merge'";class A extends Error{constructor(e){super(e)}}function V(r,e){return!(r in e)}function de(r,e){return!(e[r]instanceof Array)}function he(r,e){return typeof e[r]!="string"}function me(r,e){return!(typeof e[r]=="string"&&e[r].length>0)}function _e(r,e){return!(e[r]instanceof Array&&e[r].length>0)}function G(r){try{const e=JSON.parse(r);if(V("merge",e))throw new A(ne);if(de("merge",e))throw new A(ie);if(_e("merge",e))throw new A(oe);const t=ge(e.merge);return{...e,merge:t}}catch(e){throw e instanceof Error?e:new A("There was a problem parsing the template json")}}function ge(r){return r.map(t=>{if(V("find",t))throw new A(ue);if(V("replace",t))throw new A(fe);if(he("find",t))throw new A(ce);if(me("find",t))throw new A(pe);return t}).map(({find:t,replace:s})=>({find:t,replace:typeof s=="string"?s:JSON.stringify(s)}))}class ve{constructor(e){P(this,"template");P(this,"_result");P(this,"handlers");const t=this.parseInitialTemplate(e);this.template=t,this._result=t,this.handlers={change:[],submit:[]}}set result(e){this._result=e,this.handlers.change.forEach(t=>t(e))}get result(){return this._result}on(e,t){this.handlers[e].push(t)}submit(){this.handlers.submit.forEach(e=>e(this.result))}parseInitialTemplate(e){const s=typeof e=="string"?e:JSON.stringify(e);try{return G(s)}catch{return{merge:[]}}}setTemplateSource(e){try{const t=G(e);return this.template=t,this.result=t,t}catch(t){throw t instanceof Error?t:new Error("Error parsing JSON")}}updateResultMergeFields(e){const{find:t,replace:s}=e,i={find:t,replace:s},a=this.result.merge.map(o=>(o==null?void 0:o.find)===e.find?i:o);return this.result={...this.result,merge:a},a}}const ye=[{find:"NAME",replace:"world"}],be={tracks:[{clips:[{asset:{type:"title",text:"Hello {{ NAME }}",style:"future"},start:0,length:5}]}]},Ee={format:"mp4",resolution:"hd"},we={merge:ye,timeline:be,output:Ee};function U(r,e,t){const s=r.slice();return s[8]=e[t].find,s[9]=e[t].replace,s}function B(r){let e,t,s;return{c(){e=b("p"),t=b("span"),s=M(r[2]),this.h()},l(i){e=E(i,"P",{"data-cy":!0,class:!0});var a=w(e);t=E(a,"SPAN",{class:!0});var o=w(t);s=R(o,r[2]),o.forEach(v),a.forEach(v),this.h()},h(){c(t,"class","monospace text-orange-900 svelte-u6rap9"),c(e,"data-cy","template-input-error"),c(e,"class","bg-rose-200 rounded py-2 px-4 svelte-u6rap9")},m(i,a){D(i,e,a),h(e,t),h(t,s)},p(i,a){a&4&&C(s,i[2])},d(i){i&&v(e)}}}function H(r){let e,t,s,i,a,o=r[0].merge,l=[];for(let p=0;p<o.length;p+=1)l[p]=Y(U(r,o,p));return{c(){e=b("div"),t=b("h1"),s=M("Modify Merge Values"),i=S(),a=b("div");for(let p=0;p<l.length;p+=1)l[p].c();this.h()},l(p){e=E(p,"DIV",{"data-cy":!0,class:!0});var d=w(e);t=E(d,"H1",{class:!0});var u=w(t);s=R(u,"Modify Merge Values"),u.forEach(v),i=O(d),a=E(d,"DIV",{class:!0});var m=w(a);for(let _=0;_<l.length;_+=1)l[_].l(m);m.forEach(v),d.forEach(v),this.h()},h(){c(t,"class","text-teal-400 px-1 svelte-u6rap9"),c(a,"class","border p-4 mb-6 svelte-u6rap9"),c(e,"data-cy","merge-fields-input-section"),c(e,"class","svelte-u6rap9")},m(p,d){D(p,e,d),h(e,t),h(t,s),h(e,i),h(e,a);for(let u=0;u<l.length;u+=1)l[u].m(a,null)},p(p,d){if(d&17){o=p[0].merge;let u;for(u=0;u<o.length;u+=1){const m=U(p,o,u);l[u]?l[u].p(m,d):(l[u]=Y(m),l[u].c(),l[u].m(a,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=o.length}},d(p){p&&v(e),Z(l,p)}}}function Y(r){let e,t,s="{{ "+r[8]+" }} ",i,a,o,l,p,d,u,m,_;function I(...f){return r[7](r[8],...f)}return{c(){e=b("div"),t=b("label"),i=M(s),o=S(),l=b("input"),u=S(),this.h()},l(f){e=E(f,"DIV",{"data-cy":!0,class:!0});var n=w(e);t=E(n,"LABEL",{for:!0,class:!0});var g=w(t);i=R(g,s),g.forEach(v),o=O(n),l=E(n,"INPUT",{class:!0,id:!0,type:!0}),u=O(n),n.forEach(v),this.h()},h(){c(t,"for",a=r[8]),c(t,"class","block mb-2 monospace svelte-u6rap9"),c(l,"class","border w-full mb-3 pl-2 py-1 text-stone-500 svelte-u6rap9"),c(l,"id",p=r[8]),c(l,"type","text"),l.value=d=r[9],c(e,"data-cy","label-input"),c(e,"class","svelte-u6rap9")},m(f,n){D(f,e,n),h(e,t),h(t,i),h(e,o),h(e,l),h(e,u),m||(_=q(l,"input",I),m=!0)},p(f,n){r=f,n&1&&s!==(s="{{ "+r[8]+" }} ")&&C(i,s),n&1&&a!==(a=r[8])&&c(t,"for",a),n&1&&p!==(p=r[8])&&c(l,"id",p),n&1&&d!==(d=r[9])&&l.value!==d&&(l.value=d)},d(f){f&&v(e),m=!1,_()}}}function j(r){let e,t,s,i,a,o,l,p,d,u=JSON.stringify(r[1],null,2)+"",m,_,I;return{c(){e=b("div"),t=b("h1"),s=M("Result"),i=S(),a=b("abbr"),o=b("img"),p=S(),d=b("p"),m=M(u),this.h()},l(f){e=E(f,"DIV",{"data-cy":!0,class:!0});var n=w(e);t=E(n,"H1",{class:!0});var g=w(t);s=R(g,"Result"),g.forEach(v),i=O(n),a=E(n,"ABBR",{title:!0,class:!0});var k=w(a);o=E(k,"IMG",{src:!0,alt:!0,class:!0}),k.forEach(v),p=O(n),d=E(n,"P",{"data-cy":!0,class:!0});var y=w(d);m=R(y,u),y.forEach(v),n.forEach(v),this.h()},h(){c(t,"class","text-teal-400 px-1 inline-block mr-2 svelte-u6rap9"),x(o.src,l=ae)||c(o,"src",l),c(o,"alt","copy-button"),c(o,"class","h-4 cursor-pointer inline mb-1 svelte-u6rap9"),c(a,"title","Copy to clipboard"),c(a,"class","svelte-u6rap9"),c(d,"data-cy","result"),c(d,"class","h-60 overflow-auto border p-4 whitespace-pre monospace svelte-u6rap9"),c(e,"data-cy","result-section"),c(e,"class","svelte-u6rap9")},m(f,n){D(f,e,n),h(e,t),h(t,s),h(e,i),h(e,a),h(a,o),h(e,p),h(e,d),h(d,m),_||(I=q(o,"click",r[5]),_=!0)},p(f,n){n&2&&u!==(u=JSON.stringify(f[1],null,2)+"")&&C(m,u)},d(f){f&&v(e),_=!1,I()}}}function Ne(r){var k;let e,t,s,i,a,o,l,p,d,u,m,_,I,f=r[2]&&B(r),n=((k=r[0].merge)==null?void 0:k.length)&&!r[2]&&H(r),g=!r[2]&&j(r);return{c(){e=b("section"),t=b("form"),s=b("div"),i=b("label"),a=M("Paste template"),o=S(),l=b("textarea"),d=S(),f&&f.c(),u=S(),n&&n.c(),m=S(),g&&g.c(),this.h()},l(y){e=E(y,"SECTION",{"data-cy":!0,class:!0});var N=w(e);t=E(N,"FORM",{class:!0});var T=w(t);s=E(T,"DIV",{"data-cy":!0,class:!0});var J=w(s);i=E(J,"LABEL",{for:!0,class:!0});var L=w(i);a=R(L,"Paste template"),L.forEach(v),o=O(J),l=E(J,"TEXTAREA",{"data-cy":!0,class:!0,id:!0}),w(l).forEach(v),J.forEach(v),d=O(T),f&&f.l(T),u=O(T),n&&n.l(T),T.forEach(v),m=O(N),g&&g.l(N),N.forEach(v),this.h()},h(){c(i,"for","json-input"),c(i,"class","text-teal-400 px-1 svelte-u6rap9"),c(l,"data-cy","template-input"),c(l,"class","w-full h-60 monospace border p-4 overflow-auto whitespace-pre resize-none svelte-u6rap9"),c(l,"id","json-input"),l.value=p=JSON.stringify(r[0],null,2),c(s,"data-cy","template-input-section"),c(s,"class","mb-6 svelte-u6rap9"),c(t,"class","svelte-u6rap9"),c(e,"data-cy","form-container"),c(e,"class","max-w-lg my-4 mx-auto border rounded-xl px-7 py-4 svelte-u6rap9")},m(y,N){D(y,e,N),h(e,t),h(t,s),h(s,i),h(i,a),h(s,o),h(s,l),h(t,d),f&&f.m(t,null),h(t,u),n&&n.m(t,null),h(e,m),g&&g.m(e,null),_||(I=q(l,"input",r[3]),_=!0)},p(y,[N]){var T;N&1&&p!==(p=JSON.stringify(y[0],null,2))&&(l.value=p),y[2]?f?f.p(y,N):(f=B(y),f.c(),f.m(t,u)):f&&(f.d(1),f=null),((T=y[0].merge)==null?void 0:T.length)&&!y[2]?n?n.p(y,N):(n=H(y),n.c(),n.m(t,null)):n&&(n.d(1),n=null),y[2]?g&&(g.d(1),g=null):g?g.p(y,N):(g=j(y),g.c(),g.m(e,null))},i:F,o:F,d(y){y&&v(e),f&&f.d(),n&&n.d(),g&&g.d(),_=!1,I()}}}function Te(r,e,t){let{editTemplateService:s=new ve(we)}=e,i=s.template,a=s.result,o=null;function l(m){try{const _=s.setTemplateSource(m.target.value);t(0,i=_),t(1,a=_),t(2,o=null)}catch(_){t(2,o=_.message)}}function p(m){try{const _=s.updateResultMergeFields(m);t(1,a={...a,merge:_}),t(2,o=null)}catch(_){t(2,o=_.message)}}function d(){navigator.clipboard.writeText(JSON.stringify(a)),alert("JSON copied to clipboard!")}const u=(m,_)=>p({find:m,replace:_.currentTarget.value});return r.$$set=m=>{"editTemplateService"in m&&t(6,s=m.editTemplateService)},[i,a,o,l,p,d,s,u]}class Se extends z{constructor(e){super(),X(this,e,Te,Ne,K,{editTemplateService:6})}}function Oe(r){let e,t;return e=new Se({}),{c(){$(e.$$.fragment)},l(s){ee(e.$$.fragment,s)},m(s,i){te(e,s,i),t=!0},p:F,i(s){t||(re(e.$$.fragment,s),t=!0)},o(s){se(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}class Me extends z{constructor(e){super(),X(this,e,null,Oe,K,{})}}export{Me as default};
