var W=Object.defineProperty;var Z=(r,e,t)=>e in r?W(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var D=(r,e,t)=>(Z(r,typeof e!="symbol"?e+"":e,t),t);import{S as $,i as x,s as z,k as E,q as A,a as R,l as b,m as w,r as I,h as v,c as M,n as u,b as P,F as d,H as U,A as V,u as G,I as ee,J as te,v as re,w as se,x as le,f as ae,t as ne,y as oe}from"../../chunks/index-16192b9f.js";const ie=""+new URL("../../assets/copy-regular-1afa113a.svg",import.meta.url).href,ue="A 'merge' property is required",ce="Property 'merge' must be an array",fe="Property 'merge' must contain at least one element",pe="A 'find' property is required on every element inside 'merge'",he="Every 'find' property inside 'merge' must be of type string",de="Every 'find' property inside 'merge' must be a string of length equal to or higher than one",me="A 'replace' property is required on every element inside 'merge'",_e="Unexpected error while parsing template JSON",ve="Every element inside the 'merge' should be an object";class T extends Error{constructor(e){super(e)}}function ge(r){return typeof r=="object"}function F(r,e){return r in e}function q(r,e){return!F(r,e)}function ye(r,e){return F(r,e)&&!(e[r]instanceof Array)}function Ee(r,e){return F(r,e)&&typeof e[r]!="string"}function be(r,e){const t=F(r,e)&&e[r];return!(typeof t=="string"&&t.length>0)}function we(r,e){const t=F(r,e)&&e[r];return!(t instanceof Array&&t.length>0)}function Ne(r){try{const e=JSON.parse(r);if(q("merge",e))throw new T(ue);if(ye("merge",e))throw new T(ce);if(we("merge",e))throw new T(fe);const{merge:t}=e,s=Te(t);return{...e,merge:s}}catch(e){throw K(e)}}function Te(r){return r.map(t=>{if(!ge(t))throw new T(ve);if(q("find",t))throw new T(pe);if(q("replace",t))throw new T(me);if(Ee("find",t))throw new T(he);if(be("find",t))throw new T(de);return t}).map(({find:t,replace:s})=>({find:t,replace:Q(s)}))}function Oe(r){return typeof r=="object"&&r!==null&&"message"in r}function K(r){return r instanceof Error?r:Oe(r)?new T(r.message):new T(_e)}function Q(r){return typeof r=="string"?r:JSON.stringify(r)}class Se{constructor(e){D(this,"template");D(this,"_result");D(this,"_error");D(this,"handlers");this._error=null,this.template={merge:[]},this._result={merge:[]},this.handlers={change:[],submit:[],error:[this.logger]},this.setTemplateSource(e)}set error(e){const t=this._error&&{...this._error}||null;this._error=e,e!==null&&this.handlers.error.forEach(s=>s(e,t))}get error(){return this._error}set result(e){const t={...this._result};this._result=e,this.handlers.change.forEach(s=>s(e,t))}get result(){return this._result}on(e,t){this.handlers[e].push(t)}off(e,t){this.handlers[e].filter(s=>s!==t)}submit(){if(this.error)throw this.error;this.handlers.submit.forEach(e=>e(this.result))}setTemplateSource(e){try{const t=Ne(Q(e));this.template=t,this.result=t,this.error=null}catch(t){const s=K(t);this.error=s}}updateResultMergeFields(e){const{find:t,replace:s}=e,p={find:t,replace:s},a=this.result.merge.map(o=>(o==null?void 0:o.find)===e.find?p:o);return this.result={...this.result,merge:a},a}logger(e){console.error(e)}}const Re=[{find:"NAME",replace:"world"}],Me={tracks:[{clips:[{asset:{type:"title",text:"Hello {{ NAME }}",style:"future"},start:0,length:5}]}]},Ae={format:"mp4",resolution:"hd"},Ie={merge:Re,timeline:Me,output:Ae};function B(r,e,t){const s=r.slice();return s[9]=e[t].find,s[10]=e[t].replace,s}function H(r){let e,t,s=r[2].message+"",p;return{c(){e=E("p"),t=E("span"),p=A(s),this.h()},l(a){e=b(a,"P",{"data-cy":!0,class:!0});var o=w(e);t=b(o,"SPAN",{class:!0});var l=w(t);p=I(l,s),l.forEach(v),o.forEach(v),this.h()},h(){u(t,"class","monospace text-orange-900 svelte-u6rap9"),u(e,"data-cy","template-input-error"),u(e,"class","bg-rose-200 rounded py-2 px-4 svelte-u6rap9")},m(a,o){P(a,e,o),d(e,t),d(t,p)},p(a,o){o&4&&s!==(s=a[2].message+"")&&G(p,s)},d(a){a&&v(e)}}}function X(r){let e,t,s,p,a,o=r[0].merge,l=[];for(let c=0;c<o.length;c+=1)l[c]=Y(B(r,o,c));return{c(){e=E("div"),t=E("h1"),s=A("Modify Merge Values"),p=R(),a=E("div");for(let c=0;c<l.length;c+=1)l[c].c();this.h()},l(c){e=b(c,"DIV",{"data-cy":!0,class:!0});var h=w(e);t=b(h,"H1",{class:!0});var i=w(t);s=I(i,"Modify Merge Values"),i.forEach(v),p=M(h),a=b(h,"DIV",{class:!0});var g=w(a);for(let m=0;m<l.length;m+=1)l[m].l(g);g.forEach(v),h.forEach(v),this.h()},h(){u(t,"class","text-teal-400 px-1 svelte-u6rap9"),u(a,"class","border p-4 mb-6 svelte-u6rap9"),u(e,"data-cy","merge-fields-input-section"),u(e,"class","svelte-u6rap9")},m(c,h){P(c,e,h),d(e,t),d(t,s),d(e,p),d(e,a);for(let i=0;i<l.length;i+=1)l[i].m(a,null)},p(c,h){if(h&17){o=c[0].merge;let i;for(i=0;i<o.length;i+=1){const g=B(c,o,i);l[i]?l[i].p(g,h):(l[i]=Y(g),l[i].c(),l[i].m(a,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=o.length}},d(c){c&&v(e),ee(l,c)}}}function Y(r){let e,t,s="{{ "+r[9]+" }} ",p,a,o,l,c,h,i,g,m;function O(...f){return r[8](r[9],...f)}return{c(){e=E("div"),t=E("label"),p=A(s),o=R(),l=E("input"),i=R(),this.h()},l(f){e=b(f,"DIV",{"data-cy":!0,class:!0});var n=w(e);t=b(n,"LABEL",{for:!0,class:!0});var _=w(t);p=I(_,s),_.forEach(v),o=M(n),l=b(n,"INPUT",{class:!0,id:!0,type:!0}),i=M(n),n.forEach(v),this.h()},h(){u(t,"for",a=r[9]),u(t,"class","block mb-2 monospace svelte-u6rap9"),u(l,"class","border w-full mb-3 pl-2 py-1 text-stone-500 svelte-u6rap9"),u(l,"id",c=r[9]),u(l,"type","text"),l.value=h=r[10],u(e,"data-cy","label-input"),u(e,"class","svelte-u6rap9")},m(f,n){P(f,e,n),d(e,t),d(t,p),d(e,o),d(e,l),d(e,i),g||(m=U(l,"input",O),g=!0)},p(f,n){r=f,n&1&&s!==(s="{{ "+r[9]+" }} ")&&G(p,s),n&1&&a!==(a=r[9])&&u(t,"for",a),n&1&&c!==(c=r[9])&&u(l,"id",c),n&1&&h!==(h=r[10])&&l.value!==h&&(l.value=h)},d(f){f&&v(e),g=!1,m()}}}function j(r){let e,t,s,p,a,o,l,c,h,i=C(r[1])+"",g,m,O;return{c(){e=E("div"),t=E("h1"),s=A("Result"),p=R(),a=E("abbr"),o=E("img"),c=R(),h=E("p"),g=A(i),this.h()},l(f){e=b(f,"DIV",{"data-cy":!0,class:!0});var n=w(e);t=b(n,"H1",{class:!0});var _=w(t);s=I(_,"Result"),_.forEach(v),p=M(n),a=b(n,"ABBR",{title:!0,class:!0});var k=w(a);o=b(k,"IMG",{src:!0,alt:!0,class:!0}),k.forEach(v),c=M(n),h=b(n,"P",{"data-cy":!0,class:!0});var y=w(h);g=I(y,i),y.forEach(v),n.forEach(v),this.h()},h(){u(t,"class","text-teal-400 px-1 inline-block mr-2 svelte-u6rap9"),te(o.src,l=ie)||u(o,"src",l),u(o,"alt","copy-button"),u(o,"class","h-4 cursor-pointer inline mb-1 svelte-u6rap9"),u(a,"title","Copy to clipboard"),u(a,"class","svelte-u6rap9"),u(h,"data-cy","result"),u(h,"class","h-60 overflow-auto border p-4 whitespace-pre monospace svelte-u6rap9"),u(e,"data-cy","result-section"),u(e,"class","svelte-u6rap9")},m(f,n){P(f,e,n),d(e,t),d(t,s),d(e,p),d(e,a),d(a,o),d(e,c),d(e,h),d(h,g),m||(O=U(o,"click",r[5]),m=!0)},p(f,n){n&2&&i!==(i=C(f[1])+"")&&G(g,i)},d(f){f&&v(e),m=!1,O()}}}function ke(r){var k;let e,t,s,p,a,o,l,c,h,i,g,m,O,f=r[2]&&H(r),n=((k=r[0].merge)==null?void 0:k.length)&&!r[2]&&X(r),_=!r[2]&&j(r);return{c(){e=E("section"),t=E("form"),s=E("div"),p=E("label"),a=A("Paste template"),o=R(),l=E("textarea"),h=R(),f&&f.c(),i=R(),n&&n.c(),g=R(),_&&_.c(),this.h()},l(y){e=b(y,"SECTION",{"data-cy":!0,class:!0});var N=w(e);t=b(N,"FORM",{class:!0});var S=w(t);s=b(S,"DIV",{"data-cy":!0,class:!0});var J=w(s);p=b(J,"LABEL",{for:!0,class:!0});var L=w(p);a=I(L,"Paste template"),L.forEach(v),o=M(J),l=b(J,"TEXTAREA",{"data-cy":!0,class:!0,id:!0}),w(l).forEach(v),J.forEach(v),h=M(S),f&&f.l(S),i=M(S),n&&n.l(S),S.forEach(v),g=M(N),_&&_.l(N),N.forEach(v),this.h()},h(){u(p,"for","json-input"),u(p,"class","text-teal-400 px-1 svelte-u6rap9"),u(l,"data-cy","template-input"),u(l,"class","w-full h-60 monospace border p-4 overflow-auto whitespace-pre resize-none svelte-u6rap9"),u(l,"id","json-input"),l.value=c=C(r[0]),u(s,"data-cy","template-input-section"),u(s,"class","mb-6 svelte-u6rap9"),u(t,"class","svelte-u6rap9"),u(e,"data-cy","form-container"),u(e,"class","max-w-lg my-4 mx-auto border rounded-xl px-7 py-4 svelte-u6rap9")},m(y,N){P(y,e,N),d(e,t),d(t,s),d(s,p),d(p,a),d(s,o),d(s,l),d(t,h),f&&f.m(t,null),d(t,i),n&&n.m(t,null),d(e,g),_&&_.m(e,null),m||(O=U(l,"input",r[7]),m=!0)},p(y,[N]){var S;N&1&&c!==(c=C(y[0]))&&(l.value=c),y[2]?f?f.p(y,N):(f=H(y),f.c(),f.m(t,i)):f&&(f.d(1),f=null),((S=y[0].merge)==null?void 0:S.length)&&!y[2]?n?n.p(y,N):(n=X(y),n.c(),n.m(t,null)):n&&(n.d(1),n=null),y[2]?_&&(_.d(1),_=null):_?_.p(y,N):(_=j(y),_.c(),_.m(e,null))},i:V,o:V,d(y){y&&v(e),f&&f.d(),n&&n.d(),_&&_.d(),m=!1,O()}}}function C(r){return JSON.stringify(r,null,2)}function De(r,e,t){let{editTemplateService:s=new Se(Ie)}=e,p=s.template,a=s.result,o=null;function l(m){s.setTemplateSource(m),t(0,p=s.template),t(1,a=s.result),t(2,o=s.error)}function c(m){s.updateResultMergeFields(m),t(1,a=s.result)}function h(){navigator.clipboard.writeText(JSON.stringify(a)),alert("JSON copied to clipboard!")}const i=m=>l(m.currentTarget.value),g=(m,O)=>c({find:m,replace:O.currentTarget.value});return r.$$set=m=>{"editTemplateService"in m&&t(6,s=m.editTemplateService)},[p,a,o,l,c,h,s,i,g]}class Pe extends ${constructor(e){super(),x(this,e,De,ke,z,{editTemplateService:6})}}function Fe(r){let e,t;return e=new Pe({}),{c(){re(e.$$.fragment)},l(s){se(e.$$.fragment,s)},m(s,p){le(e,s,p),t=!0},p:V,i(s){t||(ae(e.$$.fragment,s),t=!0)},o(s){ne(e.$$.fragment,s),t=!1},d(s){oe(e,s)}}}class Ve extends ${constructor(e){super(),x(this,e,null,Fe,z,{})}}export{Ve as default};
