var x=Object.defineProperty;var ee=(r,e,t)=>e in r?x(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var F=(r,e,t)=>(ee(r,typeof e!="symbol"?e+"":e,t),t);import{S as W,i as Z,s as $,k as b,q as R,a as I,l as E,m as S,r as P,h as d,c as M,n as o,b as J,F as f,H as L,A as q,u as V,I as te,J as re,v as se,w as ae,x as le,f as ne,t as ie,y as oe}from"../../chunks/index-16192b9f.js";const ue=""+new URL("../../assets/copy-regular-1afa113a.svg",import.meta.url).href,ce="A 'merge' property is required",pe="Property 'merge' must be an array",fe="Property 'merge' must contain at least one element",he="A 'find' property is required on every element inside 'merge'",de="Every 'find' property inside 'merge' must be of type string",me="Every 'find' property inside 'merge' must be a string of length equal to or higher than one",_e="A 'replace' property is required on every element inside 'merge'";class k extends Error{constructor(e){super(e)}}function C(r,e){return!(r in e)}function ge(r,e){return!(e[r]instanceof Array)}function ve(r,e){return typeof e[r]!="string"}function ye(r,e){return!(typeof e[r]=="string"&&e[r].length>0)}function be(r,e){return!(e[r]instanceof Array&&e[r].length>0)}function B(r){try{const e=JSON.parse(r);if(C("merge",e))throw new k(ce);if(ge("merge",e))throw new k(pe);if(be("merge",e))throw new k(fe);const t=Ee(e.merge);return{...e,merge:t}}catch(e){throw e instanceof Error?e:new k("There was a problem parsing the template json")}}function Ee(r){return r.map(t=>{if(C("find",t))throw new k(he);if(C("replace",t))throw new k(_e);if(ve("find",t))throw new k(de);if(ye("find",t))throw new k(me);return t}).map(({find:t,replace:s})=>({find:t,replace:typeof s=="string"?s:JSON.stringify(s)}))}class Ne{constructor(e){F(this,"template");F(this,"result");F(this,"handlers");const t=this.parseInitialTemplate(e);this.template=t,this.result=t,this.handlers={change:[],submit:[]}}on(e,t){this.handlers[e].push(t)}submit(){this.handlers.submit.forEach(e=>e(this.result))}change(){this.handlers.change.forEach(e=>e(this.result))}parseInitialTemplate(e){const s=typeof e=="string"?e:JSON.stringify(e);try{return B(s)}catch{return{merge:[]}}}setTemplateSource(e){try{const t=B(e);return this.template=t,this.result=t,this.change(),t}catch(t){throw t instanceof Error?t:new Error("Error parsing JSON")}}updateResultMergeFields(e){const{find:t,replace:s}=e,n={find:t,replace:s},a=this.result.merge.map(u=>(u==null?void 0:u.find)===e.find?n:u);return this.result={...this.result,merge:a},this.change(),a}}const we=[{find:"NAME",replace:"world"}],Te={tracks:[{clips:[{asset:{type:"title",text:"Hello {{ NAME }}",style:"future"},start:0,length:5}]}]},Se={format:"mp4",resolution:"hd"},Oe={merge:we,timeline:Te,output:Se};function H(r,e,t){const s=r.slice();return s[9]=e[t].find,s[10]=e[t].replace,s}function Y(r){let e,t,s;return{c(){e=b("p"),t=b("span"),s=R(r[2]),this.h()},l(n){e=E(n,"P",{"data-cy":!0,class:!0});var a=S(e);t=E(a,"SPAN",{class:!0});var u=S(t);s=P(u,r[2]),u.forEach(d),a.forEach(d),this.h()},h(){o(t,"class","monospace text-orange-900 svelte-u6rap9"),o(e,"data-cy","template-input-error"),o(e,"class","bg-rose-200 rounded py-2 px-4 svelte-u6rap9")},m(n,a){J(n,e,a),f(e,t),f(t,s)},p(n,a){a&4&&V(s,n[2])},d(n){n&&d(e)}}}function j(r){let e,t,s,n,a,u=r[0].merge,l=[];for(let p=0;p<u.length;p+=1)l[p]=z(H(r,u,p));return{c(){e=b("div"),t=b("h1"),s=R("Modify Merge Values"),n=I(),a=b("div");for(let p=0;p<l.length;p+=1)l[p].c();this.h()},l(p){e=E(p,"DIV",{"data-cy":!0,class:!0});var h=S(e);t=E(h,"H1",{class:!0});var c=S(t);s=P(c,"Modify Merge Values"),c.forEach(d),n=M(h),a=E(h,"DIV",{class:!0});var g=S(a);for(let m=0;m<l.length;m+=1)l[m].l(g);g.forEach(d),h.forEach(d),this.h()},h(){o(t,"class","text-teal-400 px-1 svelte-u6rap9"),o(a,"class","border p-4 mb-6 svelte-u6rap9"),o(e,"data-cy","merge-fields-input-section"),o(e,"class","svelte-u6rap9")},m(p,h){J(p,e,h),f(e,t),f(t,s),f(e,n),f(e,a);for(let c=0;c<l.length;c+=1)l[c].m(a,null)},p(p,h){if(h&33){u=p[0].merge;let c;for(c=0;c<u.length;c+=1){const g=H(p,u,c);l[c]?l[c].p(g,h):(l[c]=z(g),l[c].c(),l[c].m(a,null))}for(;c<l.length;c+=1)l[c].d(1);l.length=u.length}},d(p){p&&d(e),te(l,p)}}}function z(r){let e,t,s="{{ "+r[9]+" }} ",n,a,u,l,p,h,c,g,m;function N(...y){return r[8](r[9],...y)}return{c(){e=b("div"),t=b("label"),n=R(s),u=I(),l=b("input"),c=I(),this.h()},l(y){e=E(y,"DIV",{"data-cy":!0,class:!0});var i=S(e);t=E(i,"LABEL",{for:!0,class:!0});var _=S(t);n=P(_,s),_.forEach(d),u=M(i),l=E(i,"INPUT",{class:!0,id:!0,type:!0}),c=M(i),i.forEach(d),this.h()},h(){o(t,"for",a=r[9]),o(t,"class","block mb-2 monospace svelte-u6rap9"),o(l,"class","border w-full mb-3 pl-2 py-1 text-stone-500 svelte-u6rap9"),o(l,"id",p=r[9]),o(l,"type","text"),l.value=h=Q(r[10]),o(e,"data-cy","label-input"),o(e,"class","svelte-u6rap9")},m(y,i){J(y,e,i),f(e,t),f(t,n),f(e,u),f(e,l),f(e,c),g||(m=L(l,"input",N),g=!0)},p(y,i){r=y,i&1&&s!==(s="{{ "+r[9]+" }} ")&&V(n,s),i&1&&a!==(a=r[9])&&o(t,"for",a),i&1&&p!==(p=r[9])&&o(l,"id",p),i&1&&h!==(h=Q(r[10]))&&l.value!==h&&(l.value=h)},d(y){y&&d(e),g=!1,m()}}}function X(r){let e,t,s;return{c(){e=b("p"),t=b("span"),s=R(r[3]),this.h()},l(n){e=E(n,"P",{"data-cy":!0,class:!0});var a=S(e);t=E(a,"SPAN",{class:!0});var u=S(t);s=P(u,r[3]),u.forEach(d),a.forEach(d),this.h()},h(){o(t,"class","monospace text-orange-900 svelte-u6rap9"),o(e,"data-cy","merge-fields-input-error"),o(e,"class","bg-rose-200 rounded py-2 px-4 svelte-u6rap9")},m(n,a){J(n,e,a),f(e,t),f(t,s)},p(n,a){a&8&&V(s,n[3])},d(n){n&&d(e)}}}function K(r){let e,t,s,n,a,u,l,p,h,c=JSON.stringify(r[1],null,2)+"",g,m,N;return{c(){e=b("div"),t=b("h1"),s=R("Result"),n=I(),a=b("abbr"),u=b("img"),p=I(),h=b("p"),g=R(c),this.h()},l(y){e=E(y,"DIV",{"data-cy":!0,class:!0});var i=S(e);t=E(i,"H1",{class:!0});var _=S(t);s=P(_,"Result"),_.forEach(d),n=M(i),a=E(i,"ABBR",{title:!0,class:!0});var w=S(a);u=E(w,"IMG",{src:!0,alt:!0,class:!0}),w.forEach(d),p=M(i),h=E(i,"P",{"data-cy":!0,class:!0});var T=S(h);g=P(T,c),T.forEach(d),i.forEach(d),this.h()},h(){o(t,"class","text-teal-400 px-1 inline-block mr-2 svelte-u6rap9"),re(u.src,l=ue)||o(u,"src",l),o(u,"alt","copy-button"),o(u,"class","h-4 cursor-pointer inline mb-1 svelte-u6rap9"),o(a,"title","Copy to clipboard"),o(a,"class","svelte-u6rap9"),o(h,"data-cy","result"),o(h,"class","h-60 overflow-auto border p-4 whitespace-pre monospace svelte-u6rap9"),o(e,"data-cy","result-section"),o(e,"class","svelte-u6rap9")},m(y,i){J(y,e,i),f(e,t),f(t,s),f(e,n),f(e,a),f(a,u),f(e,p),f(e,h),f(h,g),m||(N=L(u,"click",r[6]),m=!0)},p(y,i){i&2&&c!==(c=JSON.stringify(y[1],null,2)+"")&&V(g,c)},d(y){y&&d(e),m=!1,N()}}}function Ae(r){var G;let e,t,s,n,a,u,l,p,h,c,g,m,N,y,i=r[2]&&Y(r),_=((G=r[0].merge)==null?void 0:G.length)&&!r[2]&&j(r),w=r[3]&&X(r),T=!r[3]&&!r[2]&&K(r);return{c(){e=b("section"),t=b("form"),s=b("div"),n=b("label"),a=R("Paste template"),u=I(),l=b("textarea"),h=I(),i&&i.c(),c=I(),_&&_.c(),g=I(),w&&w.c(),m=I(),T&&T.c(),this.h()},l(v){e=E(v,"SECTION",{"data-cy":!0,class:!0});var O=S(e);t=E(O,"FORM",{class:!0});var A=S(t);s=E(A,"DIV",{"data-cy":!0,class:!0});var D=S(s);n=E(D,"LABEL",{for:!0,class:!0});var U=S(n);a=P(U,"Paste template"),U.forEach(d),u=M(D),l=E(D,"TEXTAREA",{"data-cy":!0,class:!0,id:!0}),S(l).forEach(d),D.forEach(d),h=M(A),i&&i.l(A),c=M(A),_&&_.l(A),g=M(A),w&&w.l(A),A.forEach(d),m=M(O),T&&T.l(O),O.forEach(d),this.h()},h(){o(n,"for","json-input"),o(n,"class","text-teal-400 px-1 svelte-u6rap9"),o(l,"data-cy","template-input"),o(l,"class","w-full h-60 monospace border p-4 overflow-auto whitespace-pre resize-none svelte-u6rap9"),o(l,"id","json-input"),l.value=p=JSON.stringify(r[0],null,2),o(s,"data-cy","template-input-section"),o(s,"class","mb-6 svelte-u6rap9"),o(t,"class","svelte-u6rap9"),o(e,"data-cy","form-container"),o(e,"class","max-w-lg my-4 mx-auto border rounded-xl px-7 py-4 svelte-u6rap9")},m(v,O){J(v,e,O),f(e,t),f(t,s),f(s,n),f(n,a),f(s,u),f(s,l),f(t,h),i&&i.m(t,null),f(t,c),_&&_.m(t,null),f(t,g),w&&w.m(t,null),f(e,m),T&&T.m(e,null),N||(y=L(l,"input",r[4]),N=!0)},p(v,[O]){var A;O&1&&p!==(p=JSON.stringify(v[0],null,2))&&(l.value=p),v[2]?i?i.p(v,O):(i=Y(v),i.c(),i.m(t,c)):i&&(i.d(1),i=null),((A=v[0].merge)==null?void 0:A.length)&&!v[2]?_?_.p(v,O):(_=j(v),_.c(),_.m(t,g)):_&&(_.d(1),_=null),v[3]?w?w.p(v,O):(w=X(v),w.c(),w.m(t,null)):w&&(w.d(1),w=null),!v[3]&&!v[2]?T?T.p(v,O):(T=K(v),T.c(),T.m(e,null)):T&&(T.d(1),T=null)},i:q,o:q,d(v){v&&d(e),i&&i.d(),_&&_.d(),w&&w.d(),T&&T.d(),N=!1,y()}}}function Q(r){if(typeof r=="string")return r;try{return JSON.stringify(r)}catch{return r}}function Ie(r,e,t){let{editTemplateService:s=new Ne(Oe)}=e,n=s.template,a=s.result,u,l;function p(m){try{const N=s.setTemplateSource(m.target.value);t(0,n=N),t(1,a=N),t(2,u="")}catch(N){t(2,u=N.message)}}function h(m){try{const N=s.updateResultMergeFields(m);t(1,a={...a,merge:N}),t(3,l="")}catch(N){t(3,l=N.message)}}function c(){navigator.clipboard.writeText(JSON.stringify(a)),alert("JSON copied to clipboard!")}const g=(m,N)=>h({find:m,replace:N.currentTarget.value});return r.$$set=m=>{"editTemplateService"in m&&t(7,s=m.editTemplateService)},[n,a,u,l,p,h,c,s,g]}class Me extends W{constructor(e){super(),Z(this,e,Ie,Ae,$,{editTemplateService:7})}}function ke(r){let e,t;return e=new Me({}),{c(){se(e.$$.fragment)},l(s){ae(e.$$.fragment,s)},m(s,n){le(e,s,n),t=!0},p:q,i(s){t||(ne(e.$$.fragment,s),t=!0)},o(s){ie(e.$$.fragment,s),t=!1},d(s){oe(e,s)}}}class Je extends W{constructor(e){super(),Z(this,e,null,ke,$,{})}}export{Je as default};
