var Q=Object.defineProperty;var W=(r,e,t)=>e in r?Q(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var D=(r,e,t)=>(W(r,typeof e!="symbol"?e+"":e,t),t);import{S as $,i as j,s as x,k as E,q as M,a as O,l as b,m as w,r as I,h as v,c as A,n as u,b as P,F as d,H as q,A as C,u as U,I as Z,J as ee,v as te,w as re,x as se,f as le,t as ae,y as ne}from"../../chunks/index-16192b9f.js";const oe=""+new URL("../../assets/copy-regular-1afa113a.svg",import.meta.url).href,ie="A 'merge' property is required",ue="Property 'merge' must be an array",ce="Property 'merge' must contain at least one element",pe="A 'find' property is required on every element inside 'merge'",fe="Every 'find' property inside 'merge' must be of type string",he="Every 'find' property inside 'merge' must be a string of length equal to or higher than one",de="A 'replace' property is required on every element inside 'merge'",me="Unexpected error while parsing template JSON";class R extends Error{constructor(e){super(e)}}function V(r,e){return!(r in e)}function _e(r,e){return!(e[r]instanceof Array)}function ve(r,e){return typeof e[r]!="string"}function ge(r,e){return!(typeof e[r]=="string"&&e[r].length>0)}function ye(r,e){return!(e[r]instanceof Array&&e[r].length>0)}function Ee(r){try{const e=JSON.parse(r);if(V("merge",e))throw new R(ie);if(_e("merge",e))throw new R(ue);if(ye("merge",e))throw new R(ce);const t=be(e.merge);return{...e,merge:t}}catch(e){throw z(e)}}function be(r){return r.map(t=>{if(V("find",t))throw new R(pe);if(V("replace",t))throw new R(de);if(ve("find",t))throw new R(fe);if(ge("find",t))throw new R(he);return t}).map(({find:t,replace:s})=>({find:t,replace:K(s)}))}function we(r){return typeof r=="object"&&r!==null&&"message"in r}function z(r){return r instanceof Error?r:we(r)?new R(r.message):new R(me)}function K(r){return typeof r=="string"?r:JSON.stringify(r)}class Ne{constructor(e){D(this,"template");D(this,"_result");D(this,"_error");D(this,"handlers");this._error=null,this.template={merge:[]},this._result={merge:[]},this.handlers={change:[],submit:[],error:[]},this.setTemplateSource(e)}set error(e){const t=this._error;this._error=e,e!==null&&this.handlers.error.forEach(s=>s(e,t))}get error(){return this._error}set result(e){this._result=e,this.handlers.change.forEach(t=>t(e))}get result(){return this._result}on(e,t){this.handlers[e].push(t)}submit(){if(this.error)throw this.error;this.handlers.submit.forEach(e=>e(this.result))}setTemplateSource(e){try{const t=Ee(K(e));this.template=t,this.result=t,this.error=null}catch(t){const s=z(t);this.error=s}}updateResultMergeFields(e){const{find:t,replace:s}=e,f={find:t,replace:s},a=this.result.merge.map(o=>(o==null?void 0:o.find)===e.find?f:o);return this.result={...this.result,merge:a},a}}const Te=[{find:"NAME",replace:"world"}],Se={tracks:[{clips:[{asset:{type:"title",text:"Hello {{ NAME }}",style:"future"},start:0,length:5}]}]},Oe={format:"mp4",resolution:"hd"},Ae={merge:Te,timeline:Se,output:Oe};function G(r,e,t){const s=r.slice();return s[9]=e[t].find,s[10]=e[t].replace,s}function B(r){let e,t,s=r[2].message+"",f;return{c(){e=E("p"),t=E("span"),f=M(s),this.h()},l(a){e=b(a,"P",{"data-cy":!0,class:!0});var o=w(e);t=b(o,"SPAN",{class:!0});var l=w(t);f=I(l,s),l.forEach(v),o.forEach(v),this.h()},h(){u(t,"class","monospace text-orange-900 svelte-u6rap9"),u(e,"data-cy","template-input-error"),u(e,"class","bg-rose-200 rounded py-2 px-4 svelte-u6rap9")},m(a,o){P(a,e,o),d(e,t),d(t,f)},p(a,o){o&4&&s!==(s=a[2].message+"")&&U(f,s)},d(a){a&&v(e)}}}function H(r){let e,t,s,f,a,o=r[0].merge,l=[];for(let c=0;c<o.length;c+=1)l[c]=Y(G(r,o,c));return{c(){e=E("div"),t=E("h1"),s=M("Modify Merge Values"),f=O(),a=E("div");for(let c=0;c<l.length;c+=1)l[c].c();this.h()},l(c){e=b(c,"DIV",{"data-cy":!0,class:!0});var h=w(e);t=b(h,"H1",{class:!0});var i=w(t);s=I(i,"Modify Merge Values"),i.forEach(v),f=A(h),a=b(h,"DIV",{class:!0});var g=w(a);for(let m=0;m<l.length;m+=1)l[m].l(g);g.forEach(v),h.forEach(v),this.h()},h(){u(t,"class","text-teal-400 px-1 svelte-u6rap9"),u(a,"class","border p-4 mb-6 svelte-u6rap9"),u(e,"data-cy","merge-fields-input-section"),u(e,"class","svelte-u6rap9")},m(c,h){P(c,e,h),d(e,t),d(t,s),d(e,f),d(e,a);for(let i=0;i<l.length;i+=1)l[i].m(a,null)},p(c,h){if(h&17){o=c[0].merge;let i;for(i=0;i<o.length;i+=1){const g=G(c,o,i);l[i]?l[i].p(g,h):(l[i]=Y(g),l[i].c(),l[i].m(a,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=o.length}},d(c){c&&v(e),Z(l,c)}}}function Y(r){let e,t,s="{{ "+r[9]+" }} ",f,a,o,l,c,h,i,g,m;function T(...p){return r[8](r[9],...p)}return{c(){e=E("div"),t=E("label"),f=M(s),o=O(),l=E("input"),i=O(),this.h()},l(p){e=b(p,"DIV",{"data-cy":!0,class:!0});var n=w(e);t=b(n,"LABEL",{for:!0,class:!0});var _=w(t);f=I(_,s),_.forEach(v),o=A(n),l=b(n,"INPUT",{class:!0,id:!0,type:!0}),i=A(n),n.forEach(v),this.h()},h(){u(t,"for",a=r[9]),u(t,"class","block mb-2 monospace svelte-u6rap9"),u(l,"class","border w-full mb-3 pl-2 py-1 text-stone-500 svelte-u6rap9"),u(l,"id",c=r[9]),u(l,"type","text"),l.value=h=r[10],u(e,"data-cy","label-input"),u(e,"class","svelte-u6rap9")},m(p,n){P(p,e,n),d(e,t),d(t,f),d(e,o),d(e,l),d(e,i),g||(m=q(l,"input",T),g=!0)},p(p,n){r=p,n&1&&s!==(s="{{ "+r[9]+" }} ")&&U(f,s),n&1&&a!==(a=r[9])&&u(t,"for",a),n&1&&c!==(c=r[9])&&u(l,"id",c),n&1&&h!==(h=r[10])&&l.value!==h&&(l.value=h)},d(p){p&&v(e),g=!1,m()}}}function X(r){let e,t,s,f,a,o,l,c,h,i=J(r[1])+"",g,m,T;return{c(){e=E("div"),t=E("h1"),s=M("Result"),f=O(),a=E("abbr"),o=E("img"),c=O(),h=E("p"),g=M(i),this.h()},l(p){e=b(p,"DIV",{"data-cy":!0,class:!0});var n=w(e);t=b(n,"H1",{class:!0});var _=w(t);s=I(_,"Result"),_.forEach(v),f=A(n),a=b(n,"ABBR",{title:!0,class:!0});var k=w(a);o=b(k,"IMG",{src:!0,alt:!0,class:!0}),k.forEach(v),c=A(n),h=b(n,"P",{"data-cy":!0,class:!0});var y=w(h);g=I(y,i),y.forEach(v),n.forEach(v),this.h()},h(){u(t,"class","text-teal-400 px-1 inline-block mr-2 svelte-u6rap9"),ee(o.src,l=oe)||u(o,"src",l),u(o,"alt","copy-button"),u(o,"class","h-4 cursor-pointer inline mb-1 svelte-u6rap9"),u(a,"title","Copy to clipboard"),u(a,"class","svelte-u6rap9"),u(h,"data-cy","result"),u(h,"class","h-60 overflow-auto border p-4 whitespace-pre monospace svelte-u6rap9"),u(e,"data-cy","result-section"),u(e,"class","svelte-u6rap9")},m(p,n){P(p,e,n),d(e,t),d(t,s),d(e,f),d(e,a),d(a,o),d(e,c),d(e,h),d(h,g),m||(T=q(o,"click",r[5]),m=!0)},p(p,n){n&2&&i!==(i=J(p[1])+"")&&U(g,i)},d(p){p&&v(e),m=!1,T()}}}function Re(r){var k;let e,t,s,f,a,o,l,c,h,i,g,m,T,p=r[2]&&B(r),n=((k=r[0].merge)==null?void 0:k.length)&&!r[2]&&H(r),_=!r[2]&&X(r);return{c(){e=E("section"),t=E("form"),s=E("div"),f=E("label"),a=M("Paste template"),o=O(),l=E("textarea"),h=O(),p&&p.c(),i=O(),n&&n.c(),g=O(),_&&_.c(),this.h()},l(y){e=b(y,"SECTION",{"data-cy":!0,class:!0});var N=w(e);t=b(N,"FORM",{class:!0});var S=w(t);s=b(S,"DIV",{"data-cy":!0,class:!0});var F=w(s);f=b(F,"LABEL",{for:!0,class:!0});var L=w(f);a=I(L,"Paste template"),L.forEach(v),o=A(F),l=b(F,"TEXTAREA",{"data-cy":!0,class:!0,id:!0}),w(l).forEach(v),F.forEach(v),h=A(S),p&&p.l(S),i=A(S),n&&n.l(S),S.forEach(v),g=A(N),_&&_.l(N),N.forEach(v),this.h()},h(){u(f,"for","json-input"),u(f,"class","text-teal-400 px-1 svelte-u6rap9"),u(l,"data-cy","template-input"),u(l,"class","w-full h-60 monospace border p-4 overflow-auto whitespace-pre resize-none svelte-u6rap9"),u(l,"id","json-input"),l.value=c=J(r[0]),u(s,"data-cy","template-input-section"),u(s,"class","mb-6 svelte-u6rap9"),u(t,"class","svelte-u6rap9"),u(e,"data-cy","form-container"),u(e,"class","max-w-lg my-4 mx-auto border rounded-xl px-7 py-4 svelte-u6rap9")},m(y,N){P(y,e,N),d(e,t),d(t,s),d(s,f),d(f,a),d(s,o),d(s,l),d(t,h),p&&p.m(t,null),d(t,i),n&&n.m(t,null),d(e,g),_&&_.m(e,null),m||(T=q(l,"input",r[7]),m=!0)},p(y,[N]){var S;N&1&&c!==(c=J(y[0]))&&(l.value=c),y[2]?p?p.p(y,N):(p=B(y),p.c(),p.m(t,i)):p&&(p.d(1),p=null),((S=y[0].merge)==null?void 0:S.length)&&!y[2]?n?n.p(y,N):(n=H(y),n.c(),n.m(t,null)):n&&(n.d(1),n=null),y[2]?_&&(_.d(1),_=null):_?_.p(y,N):(_=X(y),_.c(),_.m(e,null))},i:C,o:C,d(y){y&&v(e),p&&p.d(),n&&n.d(),_&&_.d(),m=!1,T()}}}function J(r){return JSON.stringify(r,null,2)}function Me(r,e,t){let{editTemplateService:s=new Ne(Ae)}=e,f=s.template,a=s.result,o=null;function l(m){s.setTemplateSource(m),t(0,f=s.template),t(1,a=s.result),t(2,o=s.error)}function c(m){s.updateResultMergeFields(m),t(1,a=s.result)}function h(){navigator.clipboard.writeText(JSON.stringify(a)),alert("JSON copied to clipboard!")}const i=m=>l(m.currentTarget.value),g=(m,T)=>c({find:m,replace:T.currentTarget.value});return r.$$set=m=>{"editTemplateService"in m&&t(6,s=m.editTemplateService)},[f,a,o,l,c,h,s,i,g]}class Ie extends ${constructor(e){super(),j(this,e,Me,Re,x,{editTemplateService:6})}}function ke(r){let e,t;return e=new Ie({}),{c(){te(e.$$.fragment)},l(s){re(e.$$.fragment,s)},m(s,f){se(e,s,f),t=!0},p:C,i(s){t||(le(e.$$.fragment,s),t=!0)},o(s){ae(e.$$.fragment,s),t=!1},d(s){ne(e,s)}}}class Fe extends ${constructor(e){super(),j(this,e,null,ke,x,{})}}export{Fe as default};
